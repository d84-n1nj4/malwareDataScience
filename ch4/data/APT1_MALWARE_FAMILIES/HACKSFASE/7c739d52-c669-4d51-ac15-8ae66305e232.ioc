<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="7c739d52-c669-4d51-ac15-8ae66305e232" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>HACKSFASE (FAMILY)</short_description>
  <description>This family of malware is a backdoor that provides reverse shell, process creation, system statistics collection, process enumeration, and process termination capabilities.
This family is designed to be a service DLL and does not contain an installation mechanism.
It usually communicates over port 443. Some variants use their own encryption, others use SSL.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">HACKSFASE</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Backdoor</link>
  </links>
  <definition>
    <Indicator operator="OR" id="034a708a-2bb0-45ad-85c5-7505d90ce2a5">
      <IndicatorItem id="c377cc91-f48d-4d1a-99bb-656cf3b706d7" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">1a0c7e61bcc50d57b7bcf9d9af691de5</Content>
      </IndicatorItem>
      <IndicatorItem id="15195f31-be5e-4e16-9d30-6f3db6107b28" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a7117612ea6b6fa3307943f5ed21fbb4</Content>
      </IndicatorItem>
      <IndicatorItem id="5da94f8b-0a61-4229-9649-031bcc12e942" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">62ea10608f0d54cd284e8d7be32f206e</Content>
      </IndicatorItem>
      <IndicatorItem id="aae5b567-4ab7-4fb2-98c8-cf684b2ad9aa" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">4749f6336eb86b5fa7029661f88ded20</Content>
      </IndicatorItem>
      <IndicatorItem id="27b93d21-246e-4a67-b099-e105dec428c3" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">be74bf5afd4ba64cc8ce237307e9254d</Content>
      </IndicatorItem>
      <IndicatorItem id="c80c0b77-8f85-444b-8b25-91cb89daaf23" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2b379d5346ffd386c28038630a9b0292</Content>
      </IndicatorItem>
      <IndicatorItem id="bba92888-f287-481d-afa9-f41c1f2324d1" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0d0240672a314a7547d328f824642da8</Content>
      </IndicatorItem>
      <IndicatorItem id="95724da5-c00f-4aa4-98e2-811d28dafe35" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f1eea61e49a3f86e95836d1c9f67e074</Content>
      </IndicatorItem>
      <IndicatorItem id="aaad91e6-b2d7-46d8-8e26-afb74292e14b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">5790c7c09735cf1ccf10625c7cd87f5e</Content>
      </IndicatorItem>
      <IndicatorItem id="75bcbb10-444e-4af6-9ded-45136b5b2199" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">656baf38fa5ee776e2576cead664d004</Content>
      </IndicatorItem>
      <IndicatorItem id="ab0ff0cb-b591-4dbc-852d-0b6c023738a6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">bcbdef1678049378be04719ed29078d2</Content>
      </IndicatorItem>
      <IndicatorItem id="9dbcdf25-be33-4433-9451-cd1594895c2b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">e9df2f69ed3d9c895ad9d399eaff1bc8</Content>
      </IndicatorItem>
      <IndicatorItem id="17e0c2b6-f87c-4ec9-9535-5e4e084a1659" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0469a42d71b4a55118b9579c8c772bb6</Content>
      </IndicatorItem>
      <IndicatorItem id="60ec0c3f-9729-4a8a-b34d-732951737b77" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">9e860622fee66074dfe81dcfcc40c4e2</Content>
      </IndicatorItem>
      <IndicatorItem id="43633d51-6eea-47f8-bb88-2b612cc8bc1e" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">9ecf9d5d8872fe55ab120265c3749ffc</Content>
      </IndicatorItem>
      <IndicatorItem id="f1d15860-1f3d-4617-8f48-3be336bfa1f6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">6c5c5e4049265fffc87973f3e4978b26</Content>
      </IndicatorItem>
      <IndicatorItem id="4fd558fc-f3a9-45d0-affe-b0d751327ce8" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">d4c1bfc5cd3e33643a562696d5d29bf2</Content>
      </IndicatorItem>
      <IndicatorItem id="5148c205-0c23-4598-b620-0693e63a4c41" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">11d350127ff1e9ecd665c34326475584</Content>
      </IndicatorItem>
      <IndicatorItem id="8fd1c9ac-5b0d-4b4a-a421-072021d1b4b2" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">d8fdd9cfca25315635378dd2564094ca</Content>
      </IndicatorItem>
      <IndicatorItem id="ceb7a04d-314f-4436-8b11-9bdfe200e22f" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">082cc969b3eb6786e3e951b450b8de0d</Content>
      </IndicatorItem>
      <IndicatorItem id="5ee5573c-3833-45b6-a5a5-d52846fd6eaf" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0cf8259502d178a099ab2852e2bddbe1</Content>
      </IndicatorItem>
      <IndicatorItem id="2a80e6d7-fa63-446b-82d6-9c45c250326c" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">17199ddac616938f383a0339f416c890</Content>
      </IndicatorItem>
      <IndicatorItem id="08cc4159-4d6f-44c8-8c58-5245f32fe88b" condition="contains">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">!@#%$^#@!</Content>
        <Comment>encoding string found in most variants of this malware family</Comment>
      </IndicatorItem>
      <Indicator operator="AND" id="05522dcd-36b9-484a-8b03-91af1853bbfd">
        <Indicator operator="OR" id="08cf27b3-d5ce-47e0-a43d-1537497b8253">
          <IndicatorItem id="d4ec4576-ff12-4456-8ccc-248b18672a4e" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">sap.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="cdc827e8-5a3a-42b6-bbad-e8e4489f3616" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">nwsap.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="46890225-6097-4468-9620-c5572c663a22" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">nwcwks.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="b2af7f69-e2b7-479c-a8e9-41f755058158" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">iass.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="1fa8eb07-242a-468d-b792-733bdf12a6f3" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">nwwkc.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="4aa84fae-cfed-490f-8325-29ce00097afd" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">irmon.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="a51199a5-b5ac-4b88-878f-75df9dfe7dc4" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">nwwkc.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="617f3e64-5fdd-4ae0-bc06-cbd12ce8f7f0" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">iassvc.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="b0f37fe1-4464-4e35-b378-a9ce2965f672" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
            <Comment>PE Header Anomaly identified in 91% samples.</Comment>
          </IndicatorItem>
          <IndicatorItem id="091bdb12-ebc2-4e1a-a8c4-c548aba4a650" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">contains_eof_data</Content>
            <Comment>PE Header Anomaly identified in 91% samples.</Comment>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="374bea42-06a9-49dd-beb5-8122bccb7186">
          <IndicatorItem id="ce6169d0-3325-46a9-9c98-11cf6f780f5e" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">173124</Content>
          </IndicatorItem>
          <IndicatorItem id="90fae1d7-2cc6-4f4e-b471-2b9dea012c1a" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">217088</Content>
          </IndicatorItem>
          <IndicatorItem id="7f004670-d978-4a24-8431-675d2290bdc2" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">217516</Content>
          </IndicatorItem>
          <IndicatorItem id="c0f7ed6a-c672-4f95-a00f-71f795282657" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">37092</Content>
          </IndicatorItem>
          <IndicatorItem id="af13e5f2-8cf3-45bb-bc87-21d778b4f26a" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">41188</Content>
          </IndicatorItem>
          <IndicatorItem id="6350d73a-0cf9-4e3c-a704-5eee07be7256" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">42052</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="00e49679-afb2-4ea8-8130-3eb2055beefd">
          <IndicatorItem id="e4dab820-2e18-4a8b-b8a0-5b1248582917" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-11-10T06:36:06Z</Content>
          </IndicatorItem>
          <IndicatorItem id="c1b8c1c7-c06d-4b63-9cd5-d2e7aa87fb21" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-11-10T08:29:48Z</Content>
          </IndicatorItem>
          <IndicatorItem id="22057da1-b30a-4599-b4bb-38cf23fbb901" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-02-01T02:27:57Z</Content>
          </IndicatorItem>
          <IndicatorItem id="2e42b550-bc10-49d6-a825-f874c6e14c04" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-03-13T07:09:49Z</Content>
          </IndicatorItem>
          <IndicatorItem id="72a5ab60-1f47-424d-813b-ae65a758e225" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-07-08T13:30:46Z</Content>
          </IndicatorItem>
          <IndicatorItem id="bd8f33e8-6a47-4dcf-896c-5225c02a8bd9" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-08-28T02:17:30Z</Content>
          </IndicatorItem>
          <IndicatorItem id="b9b87ccc-5aa2-4554-824d-787a850b7dac" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-02-25T07:48:23Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a0bfe4f6-d8df-4d11-876b-08ef669b4553" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-09-09T03:19:45Z</Content>
          </IndicatorItem>
          <IndicatorItem id="aa1b340c-5e61-4f8f-9f21-8e87e14fdaaa" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-11-10T01:41:49Z</Content>
          </IndicatorItem>
          <IndicatorItem id="5227b863-03a0-40f4-9fd2-8004d33de622" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-12-13T09:25:02Z</Content>
          </IndicatorItem>
          <IndicatorItem id="b206336f-db82-4f51-a590-cf497a53eb6d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-12-28T02:34:43Z</Content>
          </IndicatorItem>
          <IndicatorItem id="318ccd10-f142-4ab1-a8b5-93f87f1664fd" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-01-10T06:58:27Z</Content>
          </IndicatorItem>
          <IndicatorItem id="67cb8837-c241-494f-a7c4-f10bac886793" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-03-29T08:07:39Z</Content>
          </IndicatorItem>
          <IndicatorItem id="b78e17ba-ebb5-448d-8e9e-c120e64f337a" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-08T02:27:33Z</Content>
          </IndicatorItem>
          <IndicatorItem id="e002b6cf-c28e-402a-b5d0-d4c3e5e69e66" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-20T08:04:20Z</Content>
          </IndicatorItem>
          <IndicatorItem id="4ac95aef-22ec-493e-a823-83507bc603e1" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-10-27T07:47:01Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a8d538dd-06c7-4a41-8b60-cad319d1ca2b" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-02-28T15:35:51Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="8bfa6e91-8f6a-4c87-b018-a5638f44adb8">
        <IndicatorItem id="5d888420-4bb5-4529-a187-d3413ffb84a4" condition="contains">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">ServiceMain</Content>
          <Comment>This section is designed to detect a version packed w/ VMProtect</Comment>
        </IndicatorItem>
        <IndicatorItem id="7b9f4be6-3c98-4e31-bcc8-f7ebaaa7d949" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/NumberOfFunctions" type="mir" />
          <Content type="int">1</Content>
          <Comment>This section is designed to detect a version packed w/ VMProtect</Comment>
        </IndicatorItem>
        <Indicator operator="OR" id="5c991aec-3e5f-469a-acd3-898360d7cc47">
          <IndicatorItem id="862fa956-62d3-4aaa-a150-b40a1b3cdc01" condition="contains">
            <Context document="FileItem" search="FileItem/PEInfo/Sections/Section/Name" type="mir" />
            <Content type="string">.vmp0</Content>
            <Comment>This section is designed to detect a version packed w/ VMProtect</Comment>
          </IndicatorItem>
          <IndicatorItem id="458b59bf-74af-44cc-9b41-e197cc79bd8a" condition="contains">
            <Context document="FileItem" search="FileItem/PEInfo/Sections/Section/Name" type="mir" />
            <Content type="string">.vmp1</Content>
            <Comment>This section is designed to detect a version packed w/ VMProtect</Comment>
          </IndicatorItem>
          <IndicatorItem id="d02c2fc9-6726-4f1e-97e6-20f07fb0bd03" condition="contains">
            <Context document="FileItem" search="FileItem/PEInfo/Sections/Section/Name" type="mir" />
            <Content type="string">.vmp2</Content>
            <Comment>This section is designed to detect a version packed w/ VMProtect</Comment>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="5a2b9a9f-1577-48e1-96db-a2e48cc3e58d">
        <IndicatorItem id="d8b9f7dc-1a88-413e-9968-5091c69c1178" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/DllName" type="mir" />
          <Content type="string">svcdll.dll</Content>
          <Comment>recurring export name of malicious dll</Comment>
        </IndicatorItem>
        <IndicatorItem id="138d69cb-271e-4ba6-b059-352fbdf7efaa" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">ServiceMain</Content>
          <Comment>This block detects consistent characteristics of the DLL Exports of this family</Comment>
        </IndicatorItem>
        <IndicatorItem id="9f4be87c-6055-4c18-8579-9bd9f9d051c4" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/NumberOfFunctions" type="mir" />
          <Content type="int">1</Content>
        </IndicatorItem>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
