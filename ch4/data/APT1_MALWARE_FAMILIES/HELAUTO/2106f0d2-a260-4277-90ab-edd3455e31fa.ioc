<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="2106f0d2-a260-4277-90ab-edd3455e31fa" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>HELAUTO (FAMILY)</short_description>
  <description>This family of malware is designed to operate as a service and provides remote command execution and file transfer capabilities to a fixed IP address or domain name. All communication with the C2 server happens over port 443 using SSL.
This family can be installed as a service DLL. Some variants allow for uninstallation.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">HELAUTO</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Backdoor</link>
  </links>
  <definition>
    <Indicator operator="OR" id="554448f5-8e09-4c72-9dd9-5e2e1047eb33">
      <IndicatorItem id="8a8fadb8-96e5-46da-b874-ba9522968577" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">50361f8793258b6e883b31269e053ed2</Content>
      </IndicatorItem>
      <IndicatorItem id="96064940-6bcb-43b7-b2a8-dd7671c61f27" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3b320b90e024bfa48bda72aa7a82322c</Content>
      </IndicatorItem>
      <IndicatorItem id="09513ce3-4ec5-4070-87b4-6ceecf28d66b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">10bb5a8ae053e335fe047cf38db95452</Content>
      </IndicatorItem>
      <IndicatorItem id="b682a1b6-3efb-40dd-8262-26c99582e34d" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a1b924b8c8fa157ae8775fd86f692053</Content>
      </IndicatorItem>
      <IndicatorItem id="f170ec88-3afa-4602-b72b-3b05732b8a59" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2c78d8bb5912d8174042f81197d9b449</Content>
      </IndicatorItem>
      <IndicatorItem id="67bb1f06-e71f-4d6a-8c4d-45d590e25859" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f1ad5daacace5d4a7b18a03132ec2716</Content>
      </IndicatorItem>
      <IndicatorItem id="e786a178-8f96-4821-8a2f-9aea0b04bd69" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">257258344edad17f689b1c6d14833cbc</Content>
      </IndicatorItem>
      <IndicatorItem id="9bc2e53d-1fef-44b0-ad66-93329a14b18e" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">98cf219830733fb98fd2a957b7c4b163</Content>
      </IndicatorItem>
      <IndicatorItem id="b047a969-9ee5-4c47-b905-3d57dea106a8" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">75f37a69664362462ad491741a34f195</Content>
      </IndicatorItem>
      <IndicatorItem id="86cbbc7b-8373-4483-8cb4-f74d0d316b08" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">dcb90efe7e09d6900242af25aeca7b73</Content>
      </IndicatorItem>
      <IndicatorItem id="fe1b00c1-9945-4e94-9b8a-da1c14dfd592" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">62d60a1cd1e7ba73aebc98812e5ac266</Content>
      </IndicatorItem>
      <IndicatorItem id="4fde81d5-41b6-4e33-a221-d1dd64868f44" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">7ce16b35201d8d35965ec7aeebdc80ff</Content>
      </IndicatorItem>
      <IndicatorItem id="21217a83-702c-4696-9328-e9220355868c" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">b63452ecd2da62f30923a124bcd41b45</Content>
      </IndicatorItem>
      <IndicatorItem id="a2fa50e8-4165-4f32-9f0e-3fe5f47663c8" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">b2599b3078c28a278a3e7cd8b46304da</Content>
      </IndicatorItem>
      <IndicatorItem id="93f74395-d7e8-4a5f-9459-75b93dfb5652" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">e24e889e826df04f552e0d133548b693</Content>
      </IndicatorItem>
      <IndicatorItem id="4bf1eba4-af8e-4d7d-a794-6337cef6d77b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">465b085d3ddd22f63d8f7721ce5736d7</Content>
      </IndicatorItem>
      <IndicatorItem id="88fe1d0b-51cc-406e-816d-3d1877d161ab" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">04e83832146034f9797d2e8145413daa</Content>
      </IndicatorItem>
      <IndicatorItem id="2f4f9327-0216-44c8-9e53-1d23698caf72" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">c2e06531a2e6de3c1b7d18b14af53fdf</Content>
      </IndicatorItem>
      <IndicatorItem id="7e923e4e-4ac5-4c6e-8ba0-7ae8bcb2851e" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">c0a494e643c42a89d5bf718ea274df04</Content>
      </IndicatorItem>
      <IndicatorItem id="ddfdbf22-1590-4527-b017-224b8a2f24b6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">da6b0ee7ec735029d1ff4fa863a71de8</Content>
      </IndicatorItem>
      <IndicatorItem id="32fcff4b-7c5f-4e34-9783-edb887fe73a5" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">33d974011c4b047bf9874a71ba261a11</Content>
      </IndicatorItem>
      <IndicatorItem id="fa85a793-627a-48ce-91bc-e425c497a932" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">47e7f92419eb4b98ff4124c3ca11b738</Content>
      </IndicatorItem>
      <IndicatorItem id="c125aae2-69c3-4eb7-9293-c24c51d15b1c" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">12a410d82a1fc9a8c18b350872e0d465</Content>
      </IndicatorItem>
      <IndicatorItem id="75074d1b-d72f-4fb0-bd5f-6eac577a6c63" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">1ae2dadd85cd97452bb26b2c901d0890</Content>
      </IndicatorItem>
      <IndicatorItem id="0c603f6d-9b31-42df-92a9-1ce854a69aa4" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">Hello.I am here!</Content>
        <Comment>Unique C2 communication string in all samples in this family</Comment>
      </IndicatorItem>
      <IndicatorItem id="c6941c3a-15e4-47f3-b81b-74992538f067" condition="contains">
        <Context document="FileItem" search="FileItem/FullPath" type="mir" />
        <Content type="string">\Com\wscntfy.exe</Content>
        <Comment>wscntfy.exe should live in %WINDIR%\system32. The malware may call another malicious program from %WINDIR%\system32\Com\ which is not the normal location</Comment>
      </IndicatorItem>
      <Indicator operator="AND" id="36858811-aa63-43e8-a397-ee3d462764e9">
        <Indicator operator="OR" id="2b9c07e6-ec6b-4484-a4a4-12492f7b9481">
          <IndicatorItem id="bc4e6a25-4073-40b9-abb2-ff9697fb2d13" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">msiprov.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="832e2c3f-0f51-46ff-940b-21ce999aef50" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">mspmsnsv32.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="a58f5ff2-8dbe-4926-a86f-08b0bf6e24bc" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">svchost.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="3fc7d896-24f6-4a68-88a4-6b6bbb30284b" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">rasauto32.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="e4ec6bc3-ca87-46ed-aa7d-7236e3df15d6" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">ersvc.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="4f7a652e-3392-4c4a-8ee2-301968a34507" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">corrupted_imports</Content>
            <Comment>PE Header Anomaly identified in 12% samples.</Comment>
          </IndicatorItem>
          <IndicatorItem id="8284e473-1c40-4317-88e4-2274a05f8699" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
            <Comment>PE Header Anomaly identified in 100% samples.</Comment>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="5ecac869-88d1-468e-b7bc-8ce6263a6407">
          <IndicatorItem id="8399140e-d68f-4e6a-bcc1-b1a2866c4bc3" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">10240</Content>
          </IndicatorItem>
          <IndicatorItem id="19c390ad-2f2f-40c0-8da5-1bf39de9e31a" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">10752</Content>
          </IndicatorItem>
          <IndicatorItem id="b48100bd-5e0c-4d2e-bcfa-448b44abe524" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">11264</Content>
          </IndicatorItem>
          <IndicatorItem id="a75807dd-ffca-40c5-86b4-9dcde61a7c6b" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">45056</Content>
          </IndicatorItem>
          <IndicatorItem id="af2c684f-d214-4b14-bbba-41682eca0e54" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">8704</Content>
          </IndicatorItem>
          <IndicatorItem id="c096ca67-e918-4e0f-b208-782e3a511516" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">9728</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="71e585ac-078a-4d80-9086-c0c4785e3cb7">
          <IndicatorItem id="35fdebd5-e7f5-44dd-a0d6-f4e217da8814" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-06-16T02:14:07Z</Content>
          </IndicatorItem>
          <IndicatorItem id="34bf75f7-6bbd-4646-9858-d1e3f5ee4188" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-06-18T07:24:32Z</Content>
          </IndicatorItem>
          <IndicatorItem id="16d176ee-fd34-4de9-8bd6-71471e36fc03" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-09-01T16:22:56Z</Content>
          </IndicatorItem>
          <IndicatorItem id="590352a7-f3a5-461e-8e21-505d650b2f22" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-09-16T08:40:03Z</Content>
          </IndicatorItem>
          <IndicatorItem id="c2d77748-b66a-4d1f-965d-856eb1f22973" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2008-09-27T03:15:10Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a8b83474-9470-466c-961a-06bd8b2bd434" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-03-24T07:04:57Z</Content>
          </IndicatorItem>
          <IndicatorItem id="ac064633-5ad5-430e-9860-6c0603308d93" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-08-21T02:44:28Z</Content>
          </IndicatorItem>
          <IndicatorItem id="e7e4d3e5-b086-4b23-92c0-3e6aa1032123" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-04-12T07:28:12Z</Content>
          </IndicatorItem>
          <IndicatorItem id="ed3723b5-d790-4b78-a409-b5949bc0cf53" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-04-12T09:09:29Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="5a2b9a9f-1577-48e1-96db-a2e48cc3e58d">
        <IndicatorItem id="d8b9f7dc-1a88-413e-9968-5091c69c1178" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/DllName" type="mir" />
          <Content type="string">svchostdll.dll</Content>
          <Comment>representation of malicious DLL used by this family</Comment>
        </IndicatorItem>
        <IndicatorItem id="138d69cb-271e-4ba6-b059-352fbdf7efaa" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">ServiceMain</Content>
          <Comment>This block detects consistent characteristics of the DLL Exports of this family</Comment>
        </IndicatorItem>
        <IndicatorItem id="a5a8e2b5-3d88-4363-aa86-7bf57d0c7488" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">InstallA</Content>
        </IndicatorItem>
        <IndicatorItem id="022b41f1-9afe-45d6-af8b-1b157177025d" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">UninstallService</Content>
        </IndicatorItem>
        <IndicatorItem id="ecc8fb90-5a68-4963-9b33-03ede415351b" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">InstallService</Content>
        </IndicatorItem>
        <IndicatorItem id="5b4f193e-557f-4224-bb18-cda6555dc52f" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">RemoveA</Content>
        </IndicatorItem>
        <IndicatorItem id="9f4be87c-6055-4c18-8579-9bd9f9d051c4" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/NumberOfFunctions" type="mir" />
          <Content type="int">5</Content>
        </IndicatorItem>
      </Indicator>
      <Indicator operator="AND" id="3d996e6f-1a80-4dba-819e-797a2412fcce">
        <IndicatorItem id="20070b1b-c544-40e4-88b0-fc7533f9bda7" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/DllName" type="mir" />
          <Content type="string">svchostdll.dll</Content>
          <Comment>representation of malicious DLL used by this family</Comment>
        </IndicatorItem>
        <IndicatorItem id="4f356464-9e28-470f-8b4d-67553bdee05c" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">ServiceMain</Content>
        </IndicatorItem>
        <IndicatorItem id="db01b082-bfca-4493-9a89-c5ea64768065" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/NumberOfFunctions" type="mir" />
          <Content type="int">1</Content>
        </IndicatorItem>
      </Indicator>
      <Indicator operator="AND" id="86853fd5-a9c2-480f-af96-521d047d4da2">
        <IndicatorItem id="56267a8f-9633-4937-8de4-9085d355b3f2" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/DllName" type="mir" />
          <Content type="string">comhttps.dll</Content>
          <Comment>representation of malicious DLL used by this family</Comment>
        </IndicatorItem>
        <IndicatorItem id="d5c98410-ee98-458e-a5b6-be970abb3a43" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">DllUnregisterServer</Content>
        </IndicatorItem>
        <IndicatorItem id="428d8ae8-11ac-41c8-8cf8-e3626f976635" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">DllGetClassObject</Content>
        </IndicatorItem>
        <IndicatorItem id="a7ea89f3-847c-444d-b329-f1f93bf43d24" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">DllCanUnloadNow</Content>
        </IndicatorItem>
        <IndicatorItem id="14bf2c6c-2c39-44c8-92ed-caf34aa76456" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">DllRegisterServer</Content>
        </IndicatorItem>
        <IndicatorItem id="139fc1a6-e5f8-478f-ac4c-4e5ef4d5d7a7" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/NumberOfFunctions" type="mir" />
          <Content type="int">4</Content>
        </IndicatorItem>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
