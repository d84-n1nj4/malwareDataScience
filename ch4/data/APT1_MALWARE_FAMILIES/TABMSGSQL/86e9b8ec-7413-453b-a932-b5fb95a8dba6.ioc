<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="86e9b8ec-7413-453b-a932-b5fb95a8dba6" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>TABMSGSQL (FAMILY)</short_description>
  <description>This malware family is a full-featured backdoor capable of file uploading and downloading, arbitrary execution of programs, and providing a remote interactive command shell.
All communications with the C2 server are sent over HTTP to a static URL, appending various URL parameters to the request. Some variants use a slightly different URL.
The C2 server appears to act as just a database, allowing the clients to craft and execute SQL statements of their choosing. The malware also implements a special mode that provides full administrative access to the C2 server. This includes displaying the status of clients who have checked in with the C2 server, queuing commands to any client, and uploading or downloading files to the C2 server.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">TABMSGSQL</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Backdoor</link>
  </links>
  <definition>
    <Indicator operator="OR" id="2c6d4480-4276-416a-ba13-26c7598fe55c">
      <IndicatorItem id="0bd6f414-d5af-4a85-bf84-377abb903c21" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">1c7538951b21d93ef7ecf3fa94ae5c5e</Content>
      </IndicatorItem>
      <IndicatorItem id="e7257d4c-a18c-4e83-be75-b40a7b739d19" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">052ec04866e4a67f31845d656531830d</Content>
      </IndicatorItem>
      <IndicatorItem id="5e7f8377-891e-4d53-aa40-9d662477d567" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">016da6ee744b16656a2ba3107c7a4a29</Content>
      </IndicatorItem>
      <IndicatorItem id="df2cea97-90d2-426f-930b-b783f49ee095" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">b47e5d095be9fd61016817359f6c2887</Content>
      </IndicatorItem>
      <IndicatorItem id="b73ed629-7f0a-4ed2-8ade-38f2c4061dd4" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2af105519133baaee57c9ade00543de2</Content>
      </IndicatorItem>
      <IndicatorItem id="6de65dff-bc02-406e-8776-e70e287dd597" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">83b3711c32d28a87b173e7e5aba5f826</Content>
      </IndicatorItem>
      <IndicatorItem id="7a2f2582-73a8-4a06-b52b-c589bedda1ad" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">e6ff0431a9a9028808efc582405ea7df</Content>
      </IndicatorItem>
      <IndicatorItem id="f384c66b-37ac-4acf-8d72-55b04dd6a9c0" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">79841c13f645118a600d19def3642d1a</Content>
      </IndicatorItem>
      <IndicatorItem id="7fd10ee3-26ec-414e-b4b4-878f91436912" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">bee9b7835a02973678e9ead683da1ac4</Content>
      </IndicatorItem>
      <IndicatorItem id="b2e13e8b-952f-4a59-be04-dfdf5eca3f8c" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3cda17269c246a2e3bfcda6fa02fceb8</Content>
      </IndicatorItem>
      <IndicatorItem id="b9f05433-78c0-4082-ab10-3a78b7ab2a5d" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">16e53c619803d0068611bb6d448d1d49</Content>
      </IndicatorItem>
      <IndicatorItem id="976eb5ba-0810-4afd-a3c1-2a04d8e9c2c4" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2156942db0293565c9420c1e254a2c32</Content>
      </IndicatorItem>
      <IndicatorItem id="ca570199-0523-4f49-bfb4-a7be03752326" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">001dd76872d80801692ff942308c64e6</Content>
      </IndicatorItem>
      <IndicatorItem id="6a9a8058-7045-4722-9d07-c778f29691c2" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f02abd537e481109142b6170933d1b3d</Content>
      </IndicatorItem>
      <IndicatorItem id="82c4f0c2-0ab2-456a-852b-48a768aa9dee" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">002325a0a67fded0381b5648d7fe9b8e</Content>
      </IndicatorItem>
      <IndicatorItem id="d108d2a2-e41f-42ac-aa6e-42b23cc74e93" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">7f398b00546c3a0946cd6142c308a556</Content>
      </IndicatorItem>
      <IndicatorItem id="22b11880-c237-480f-ae52-917a7ed55566" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">ef0a6c79f99a537f932a5e64999972b3</Content>
      </IndicatorItem>
      <IndicatorItem id="d171f8b5-21c0-4c5c-a3bc-cbe127692c0d" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">86b68ad2e9c33eadf134285ea142ccc2</Content>
      </IndicatorItem>
      <IndicatorItem id="9ab45d6b-565e-4b64-b93f-b23e687937ae" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2f930d92dc5ebc9d53ad2a2b451ebf65</Content>
      </IndicatorItem>
      <IndicatorItem id="ea867aab-ee81-42aa-a6f2-2b7515972a4b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">68d2fd5049e70942d164e4e25d13dd8e</Content>
      </IndicatorItem>
      <IndicatorItem id="4e840329-9123-4119-9ce0-1fca6fa7c3c4" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">8a86df3d382bfd1e4c4165f4cacfdff8</Content>
      </IndicatorItem>
      <IndicatorItem id="5dbc4c91-60d8-42d8-b1e7-b107c6fd80a4" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">99a7e4a01b813b9b26ba76bf0b484742</Content>
      </IndicatorItem>
      <IndicatorItem id="66cd7040-0c0d-4d63-8b74-b6f9b948e1ee" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">55886d571c2a57984ea9659b57e1c63a</Content>
      </IndicatorItem>
      <IndicatorItem id="17bae05f-e5e9-47f2-b1f9-9d6cce455b19" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3e87051b1dc3463f378c7e1fe398dc7d</Content>
      </IndicatorItem>
      <IndicatorItem id="efb7dbc2-46a7-4fb0-8bd2-cfdcc99daf6c" condition="contains">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">letusgohtppmmv2.0.0.1</Content>
        <Comment>string artifact of mutant created by some versions of the malware</Comment>
      </IndicatorItem>
      <Indicator operator="AND" id="38a72bf1-1cc5-4d4a-bb9e-a1fc19c2fad7">
        <Indicator operator="OR" id="e005cff2-a061-415e-914b-2f49e3064aee">
          <IndicatorItem id="6fc8e033-46f5-4457-b09c-72ef013d8d01" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">reader_sl.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="330d109e-d67d-400c-8782-d419d8c8fdea" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">httpmm.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="cdc14485-a104-416a-a6e9-b5a0053b4e14" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">adobearm.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="432017a3-cf8e-46c7-9c2b-9abd9347aaa4" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http1+.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="5c4f91ef-b91f-4214-b8e3-d0093dc1d713" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http2+.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="47462879-ba51-4c06-b184-ac6f24fde5a7" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http3+.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f780ed3e-99a5-42a6-b87e-34239a9e9f98" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http4+.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="085bdd85-79a6-442b-982e-728cec1f0edb" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http5+.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="9788ddbd-d0f6-4775-b4dd-2b0824f23aef" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http6+.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d6d47b03-1b98-4da1-8947-ec1b39571d67" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">inetinfo.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="cad6845d-48ab-4dba-80c1-11a4d24287fc" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">setup.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="9cf44dd1-bc08-4ce1-9c3f-5cf36d2e9554" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">setupaa.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="ee53f8a8-b073-4a23-ac53-5a2bcc248c2b" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">http1.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="13944004-8d57-46a8-9095-7f3627028bb2" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">contains_eof_data</Content>
            <Comment>PE Header Anomaly identified in 4% samples.</Comment>
          </IndicatorItem>
          <IndicatorItem id="b79b4e26-9906-47b1-97e8-7851dd4ca153" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
            <Comment>PE Header Anomaly identified in 71% samples.</Comment>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="3bd7e49a-e2a7-4f4f-8d6f-781e20b3e861">
          <IndicatorItem id="04f95431-b14d-43c2-a469-76ec2dfca5d2" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">26085</Content>
          </IndicatorItem>
          <IndicatorItem id="5ce072f5-455d-4457-9a55-e43f796b05c8" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">26112</Content>
          </IndicatorItem>
          <IndicatorItem id="4c60995e-0101-422c-aa6a-442bd4c72274" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">26624</Content>
          </IndicatorItem>
          <IndicatorItem id="f23cad9e-d703-48cd-bdf4-6c4c51587d1b" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">32734</Content>
          </IndicatorItem>
          <IndicatorItem id="efd2b400-30a3-44e4-b9c6-e998bf1bd7d1" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">32768</Content>
          </IndicatorItem>
          <IndicatorItem id="8791f0d6-eb97-4dbc-bd90-bacff1692af4" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">33792</Content>
          </IndicatorItem>
          <IndicatorItem id="58428dae-3ddf-45b1-b9d6-191fbf15386e" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">33829</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="f784009f-474c-481c-b916-6a5eb5171217">
          <IndicatorItem id="77056ecd-8481-41ba-8a52-f6ebbb2f4672" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-10-19T08:15:54Z</Content>
          </IndicatorItem>
          <IndicatorItem id="18fa2007-837a-4d7f-a497-4726d84e5e63" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-10-20T03:05:15Z</Content>
          </IndicatorItem>
          <IndicatorItem id="e95325be-a318-46f2-a3f3-3666164bd40d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-11-02T08:35:56Z</Content>
          </IndicatorItem>
          <IndicatorItem id="d3ae8857-2edd-4c7b-b030-97e02aff3d93" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-11-04T06:07:11Z</Content>
          </IndicatorItem>
          <IndicatorItem id="fc57d943-b0a7-414e-aff4-06c3dc1dca8a" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-11-01T02:43:26Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="01ef6ff8-8050-44d6-bd54-f35e523315ab">
        <IndicatorItem id="9a29dd0d-ad67-42eb-9e3f-d2e7e485099f" condition="is">
          <Context document="ProcessItem" search="ProcessItem/HandleList/Handle/Type" type="mir" />
          <Content type="string">Mutant</Content>
        </IndicatorItem>
        <IndicatorItem id="a91296f4-e0e0-454d-8fae-a8a55a77e457" condition="is">
          <Context document="ProcessItem" search="ProcessItem/HandleList/Handle/Name" type="mir" />
          <Content type="string">letusgohtppmmv2.0.0.1</Content>
          <Comment>mutant created by some versions of the malware</Comment>
        </IndicatorItem>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
