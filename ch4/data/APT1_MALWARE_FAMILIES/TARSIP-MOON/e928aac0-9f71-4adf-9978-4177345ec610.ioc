<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="e928aac0-9f71-4adf-9978-4177345ec610" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>TARSIP-MOON (FAMILY)</short_description>
  <description>The TARSIP malware family is a backdoor which communicates over encoded information in HTTPS headers.  Typical TARSIP malware samples will only beacon out to their C2 servers if the C2 DNS address resolves to a specific address.  The capability of TARSIP backdoors includes file uploading, file downloading, interactive command shells, process enumeration, process creation, process termination. The TARSIP-MOON family is distinguished by the presence of 'moon' in .pdb debug strings present in the malware samples.  It does not provide a built in mechanism to maintain persistence.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="category">Backdoor</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="family">TARSIP-MOON</link>
  </links>
  <definition>
    <Indicator operator="OR" id="330cf804-e267-42cb-820f-af444f1e9fd8">
      <IndicatorItem id="5cc3ed5a-17cd-4bc6-bc3d-554b92cda3b4" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">898a8a43c8708961094944fb42c278ab</Content>
      </IndicatorItem>
      <IndicatorItem id="ef95aa56-e653-4357-9627-99df04400546" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">07fe9f901fb4f14e16fb5d114a92b0fc</Content>
      </IndicatorItem>
      <IndicatorItem id="ef3492cb-db10-40bb-9898-22f7a54c4b5f" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2e8484f59899046452392c236460ebb6</Content>
      </IndicatorItem>
      <IndicatorItem id="85ce02c6-16ec-4927-8477-20bd38b0cdf2" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">9d1d58e370bea4b5e79a1f914516cbc0</Content>
      </IndicatorItem>
      <IndicatorItem id="c1fd7932-8473-40fc-b598-dac2954be212" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0908d8b3e459551039bade50930e4c1b</Content>
      </IndicatorItem>
      <IndicatorItem id="2b7c7b9f-dc3d-4f92-9ef7-c4eea56b7a48" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">950234183528ce107d65b700be1bbbd3</Content>
      </IndicatorItem>
      <IndicatorItem id="e080662b-2364-41a2-a020-cb1b0c971e91" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a5d4ebc0285f0213e0c29d23bc410889</Content>
      </IndicatorItem>
      <IndicatorItem id="a82948a5-8b29-4135-aac2-60133ea45c75" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">494637c4ac6d04bb50a681e87b81043f</Content>
      </IndicatorItem>
      <IndicatorItem id="9dd97cd1-a202-423e-9d4d-207e5edb8d14" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">6c9c9e40683467f60b910d5bad5285ae</Content>
      </IndicatorItem>
      <IndicatorItem id="d5cb1b59-03b0-45dd-9b85-75ee78f90044" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3d61d23c2be95177937aa50769c0c512</Content>
      </IndicatorItem>
      <IndicatorItem id="86c51237-c66d-48c1-a341-cf8c0d91c60a" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">c91eacab7655870764d13ba741aa9a73</Content>
      </IndicatorItem>
      <IndicatorItem id="1e0981b5-b053-4b0a-8211-a6cf7c3b1a3f" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">588c40520a3cea27d2b35cd1fa05e23f</Content>
      </IndicatorItem>
      <IndicatorItem id="5b2f7279-ce22-4b70-af8d-8923437849fd" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">6a88f170ab6cb0f9b3252adc61b4f487</Content>
      </IndicatorItem>
      <IndicatorItem id="347bfe1f-2df9-4c96-9513-2d7a3c0d74f1" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">565b6fedccab184c92e40483ea49a25f</Content>
      </IndicatorItem>
      <IndicatorItem id="2d2d3672-e987-4d69-b253-7d28e39629d8" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">feb406ff01d9fd5abc5ea079e0543e31</Content>
      </IndicatorItem>
      <IndicatorItem id="c9bf6fef-3417-4a0d-94ee-7f34aa31c707" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f4bea18e9d38ab9fa7c1cf6eea2bdc79</Content>
      </IndicatorItem>
      <IndicatorItem id="7e10c0e2-11dd-44bc-a282-9ed6f9bb4310" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">8d81eeaeb0bd74a1faab257079452078</Content>
      </IndicatorItem>
      <IndicatorItem id="f6db7186-d473-41a0-812e-4d264d834fa8" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">ca9c1f8d709ed34d388dc7cba2bd7602</Content>
      </IndicatorItem>
      <IndicatorItem id="81ae4127-cbeb-4c91-8400-748c5127a733" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">95f25d3afc5370f5d9fd8e65c17d3599</Content>
      </IndicatorItem>
      <IndicatorItem id="7f53e613-ff9b-491f-8ca9-ba55e3a4b9c3" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">b883f8e5a1420d1f511266b9253c11c4</Content>
      </IndicatorItem>
      <IndicatorItem id="4adc3ef2-d407-4a82-90e6-8dce6ca01c68" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2bd02b41817d227058522cca40acd390</Content>
      </IndicatorItem>
      <IndicatorItem id="a62c6ba2-03ce-4e80-bd8a-45138fe31911" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">74b3ee9f3f6c52413db6e5c9ace34893</Content>
      </IndicatorItem>
      <IndicatorItem id="13bfb143-a945-42da-b03a-3224843729bf" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">c4188c3bb6982d41aa783c499113a8e3</Content>
      </IndicatorItem>
      <IndicatorItem id="3c1cba50-dbda-47e1-ab8a-40960cac9d39" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2acfc925e66e1b820a67c4d0f3e6ae8c</Content>
      </IndicatorItem>
      <IndicatorItem id="f81d536b-7d51-4b41-bd87-21c7d4d11719" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">8bf9698c18b2aa23f71444af2571a6ad</Content>
      </IndicatorItem>
      <IndicatorItem id="095f937e-ef8d-4dac-bbff-3d042e7b5151" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">34ca3fbcaac48498aeff6035b172bf69</Content>
      </IndicatorItem>
      <IndicatorItem id="a3cab055-1cd0-43cc-ba82-9dd4bd105656" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">6808ec6dbb23f0fa7637c108f44c5c80</Content>
      </IndicatorItem>
      <IndicatorItem id="feb4f745-5dcb-4cc4-93d2-fde7b172c5c2" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">bf0d5aff9c1f33e089c9c85f03c6ba8a</Content>
      </IndicatorItem>
      <IndicatorItem id="c87057f3-4180-4d85-9d98-e9922705fa6c" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">7a2692cafec377c444bc3147fc43e57f</Content>
      </IndicatorItem>
      <IndicatorItem id="ad3076d7-7912-4eee-b9b5-450d09f9b840" condition="is">
        <Context document="FileItem" search="FileItem/PEInfo/Exports/DllName" type="mir" />
        <Content type="string">MoonService2.dll</Content>
      </IndicatorItem>
      <IndicatorItem id="4e169fbc-be2e-410d-bfa3-6676937fed7d" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">Shell is not exist or stopped!</Content>
      </IndicatorItem>
      <IndicatorItem id="e42105cf-324d-4dc6-ab46-c9c7fa70dc63" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">Can not open file on client!</Content>
      </IndicatorItem>
      <IndicatorItem id="06fe0f22-cd53-4475-afc2-ba0f22615557" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\pjts2008\moon\Release\MoonDLL2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="e25a955a-1756-4886-ae24-a0e2f455b906" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\pjts2008\moon\Release\MoonClient2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="812f42dd-d34c-4209-a211-57708c7e747a" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\code\moon1.5\Release\MoonClient2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="50177099-34c0-45f9-ac09-6de4a249c3ce" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\XiaoME\SunCloud-Code\WinHTTP 1.2.5\Release\MoonDll.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="71845e68-3977-4fe0-b75c-74cf736b671e" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\C\moon1.5\Release\MoonDll.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="b96820dd-a93a-40ac-8868-03e543779932" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\C\moon1.5\Release\MoonClient2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="7aa29d02-3f1d-44c6-9a2c-8dc9bbdbabe6" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\C\moon1.5\Release\MoonService2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="3edc10e5-7abc-4ecf-bc2b-efb5493a1dc8" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">D:\M tools\Moon\Release\MoonClient2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="9b990209-254b-452d-8270-a1e3707f4f8b" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\C\moon1.5\Release\MoonDLL2.pdb</Content>
      </IndicatorItem>
      <IndicatorItem id="1d819b3d-e279-4d77-a6ee-6ef0f45f4b7d" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">E:\XiaoME\SunCloud-Code\moon1.5\Release\MoonDLL2.pdb</Content>
      </IndicatorItem>
      <Indicator operator="AND" id="0e1d2df2-f03a-4da5-8bcc-a63f78d38877">
        <IndicatorItem id="636e4e8a-cb6a-45a5-9df1-4f20e1132f71" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
          <Content type="string">checksum_mismatch</Content>
          <Comment>PE Header Anomaly identified in 100% samples.</Comment>
        </IndicatorItem>
        <IndicatorItem id="14a13876-3ab2-4227-ad8c-451dcd0519f0" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
          <Content type="string">contains_eof_data</Content>
          <Comment>PE Header Anomaly identified in 100% samples.</Comment>
        </IndicatorItem>
        <Indicator operator="OR" id="92dcbcc1-b7aa-4e87-aa2e-3ba81e3cedee">
          <IndicatorItem id="b37cc63f-6502-4977-9d81-5608bc17d42d" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">121.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="2ce40817-edf3-4219-aa01-80471b82c2c9" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">162.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d03530b4-8d5e-41fe-896f-301ca58076cc" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">download.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="ddaccedf-90d7-4224-9d52-fed8d2a8082d" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">igfxper.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="6c7dc0e9-79a6-4be8-bf71-dff9f626ec7d" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">md2.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="ba2b6ece-f761-4644-b707-70ff165877ec" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">mfevps.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="1dd4cb8c-b1f8-494a-be6a-ca93b00743ac" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">moon.png</Content>
          </IndicatorItem>
          <IndicatorItem id="cd3a79a6-d176-41d6-a785-acba8e83c52b" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">nbstat.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="7d00969b-768d-4df4-a890-06c7030f5223" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">ntdl.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="650d994c-739c-4969-9251-49bfa8dcb102" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">ntshrui.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="336be1c5-f3f2-4e47-a56e-011577a13c2b" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">sap.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="a57d27fb-ee5f-48e7-bc8b-eb28b72e0598" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">Slsvc.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="2f5f27d2-3f7a-41ff-a21a-67ed4ad5dc2c" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">win6C.exe</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="6ffbea9a-28a8-4f64-9da6-135e7701da4b">
          <IndicatorItem id="4a52cb2b-9c78-4ac0-8b97-cc054a54a3f0" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">145900 TO 146000</Content>
          </IndicatorItem>
          <IndicatorItem id="4a510c2d-0a0a-41f9-a780-0b9a184e73b9" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">149540</Content>
          </IndicatorItem>
          <IndicatorItem id="9c0b99a8-1b3d-48cc-b9bf-f40feffe72cd" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">150564</Content>
          </IndicatorItem>
          <IndicatorItem id="e993d0d6-61f8-4fb4-93ea-db2666d6e843" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">151588</Content>
          </IndicatorItem>
          <IndicatorItem id="80bb7921-4817-48d3-878a-6712dd7faace" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">157732</Content>
          </IndicatorItem>
          <IndicatorItem id="bee37401-87df-4fe3-8bec-e38286e9b821" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">158000 TO 160400</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="c91fd813-be30-4331-aff5-09c168bc5c64">
          <IndicatorItem id="4f928e37-08d2-46f1-a183-a3fd4818e8be" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-02-23T14:23:21Z</Content>
          </IndicatorItem>
          <IndicatorItem id="10b6b09a-7e45-45c3-b833-00005caf0ea9" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-03-24T03:43:02Z</Content>
          </IndicatorItem>
          <IndicatorItem id="9a15ea1c-c2b2-447b-9011-b1e8542433d5" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-01T17:41:45Z</Content>
          </IndicatorItem>
          <IndicatorItem id="42946ae8-b28a-482f-9a84-bdde2098a5dc" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-13T09:22:06Z</Content>
          </IndicatorItem>
          <IndicatorItem id="b972ea4d-c4c9-4fab-9e57-8478764f5c16" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-20T07:00:00Z TO 2011-04-20T14:00:00Z</Content>
          </IndicatorItem>
          <IndicatorItem id="3b8c093d-414f-49a9-b7dd-22b68a238726" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-21T07:16:51Z</Content>
          </IndicatorItem>
          <IndicatorItem id="d19129ad-cb3e-48c5-9188-c355b342aca6" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-05-04T16:10:36Z</Content>
          </IndicatorItem>
          <IndicatorItem id="65772a1c-3690-451c-bafe-869944742746" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-05-11T08:39:16Z</Content>
          </IndicatorItem>
          <IndicatorItem id="c79d6f9a-7528-4878-87e4-1d75d5d31b5c" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-05-31T08:37:56Z</Content>
          </IndicatorItem>
          <IndicatorItem id="e787f4b2-b375-4a86-a870-b1a0fe91cbe5" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-06-02T01:41:52Z</Content>
          </IndicatorItem>
          <IndicatorItem id="9acd4092-e331-4503-be88-5ab9f3e50d4d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-06-02T01:42:07Z</Content>
          </IndicatorItem>
          <IndicatorItem id="77cb33c7-e73f-4c38-8108-9b4f4be6e36d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-06-16T00:36:06Z</Content>
          </IndicatorItem>
          <IndicatorItem id="341631f1-5d80-4471-b7cb-f67e846461bf" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-07-11T03:38:22Z</Content>
          </IndicatorItem>
          <IndicatorItem id="2a379e3d-7a56-413f-9970-9f42d095e052" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-09-22T13:52:10Z</Content>
          </IndicatorItem>
          <IndicatorItem id="0770e7b6-6b92-40e4-812a-6ef828fbcb1c" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-04-12T15:02:26Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
