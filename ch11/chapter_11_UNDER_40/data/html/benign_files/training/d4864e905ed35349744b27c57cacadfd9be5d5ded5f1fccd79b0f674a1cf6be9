<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <title>tCouchbaseOutput</title><link rel="stylesheet" type="text/css" href="../css/talend_components_eclipse.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><meta name="keywords" content="tcouchbaseoutput, couchbase"><link rel="home" href="bk-components-rg-en..html" title="Talend Components"><link rel="up" href="ch-bigdata.html" title="Chapter&nbsp;1.&nbsp;Big Data components"><link rel="prev" href="tCouchbaseInput.html" title="tCouchbaseInput"><link rel="next" href="tCouchDBClose.html" title="tCouchDBClose"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">tCouchbaseOutput</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tCouchbaseInput.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Big Data components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="tCouchDBClose.html">Next</a></td></tr></table><hr></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tCouchbaseOutput"></a>tCouchbaseOutput</h2></div></div></div><div class="mediaobject"><img src="../images/tcouchbaseoutput_icon32_white.png"></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p><span class="emphasis"><em>This component will be available in the <span class="emphasis"><strong>Palette</strong></span> of the studio on the condition that you have subscribed to
				one of the <span class="emphasis"><strong>Talend</strong></span> solutions with Big
				Data.</em></span>
		</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9182"></a>tCouchbaseOutput Properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Component family</strong></span>
							</p>
						</td><td valign="top">
							<p>Big Data / Couchbase</p>
						</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>tCouchbaseOutput</strong></span> inserts,
								updates, upserts or deletes the documents in the Couchbase database
								which are stored in the form of Key/Value pairs, where the Value can
								be JSON or binary data. </p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>This component allows you to perform actions on the JSON or binary
								documents stored in the Couchbase database based on the incoming
								flat data from a file, a database table etc. </p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Schema</em></span> and <span class="emphasis"><em>Edit
								Schema</em></span></p>
						</td><td valign="top">
							<p>A schema is a row description. It defines the number of fields to be processed and passed on
		to the next component. The schema is either <span class="emphasis"><strong>Built-In</strong></span> or
		stored remotely in the <span class="emphasis"><strong>Repository</strong></span>.</p>
							<p>Since version 5.6, both the Built-In mode and the Repository mode are
		available in any of the <span class="emphasis"><em>Talend</em></span> solutions.</p>
							<p>Click <span class="emphasis"><strong>Edit schema</strong></span> to make changes to the schema. If the
		current schema is of the <span class="emphasis"><strong>Repository</strong></span> type, three options are
		available:</p>
							<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="emphasis"><strong>View schema</strong></span>: choose this option to view the
				schema only.</p></li><li class="listitem"><p><span class="emphasis"><strong>Change to built-in property</strong></span>: choose this option
				to change the schema to <span class="emphasis"><strong>Built-in</strong></span> for local
				changes.</p></li><li class="listitem"><p><span class="emphasis"><strong>Update repository connection</strong></span>: choose this option to change
				the schema stored in the repository and decide whether to propagate the changes to
				all the Jobs upon completion. If you just want to propagate the changes to the
				current Job, you can select <span class="emphasis"><strong>No</strong></span> upon completion and
				choose this schema metadata again in the <span class="emphasis"><strong>[Repository
					Content]</strong></span> window.</p></li></ul></div>
							<p> Click <span class="emphasis"><strong>Sync columns</strong></span> to retrieve the schema from the
		previous component connected in the Job.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><strong>Built-In</strong></span>: You create and store the schema locally for this
		component only. Related topic: see <span class="emphasis"><em>Talend Studio</em></span>
		<span class="emphasis"><em>User Guide</em></span>.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><strong>Repository</strong></span>: You have already created the schema and
		stored it in the Repository. You can reuse it in various projects and Job designs. Related
		topic: see <span class="emphasis"><em>Talend Studio</em></span><span class="emphasis"><em> User Guide</em></span>.</p>
							<p>When the schema to be reused has default values that are integers or functions, ensure that
		these default values are not enclosed within quotation marks. If they are, you must remove
		the quotation marks manually.</p>
							<p>For more details, see <a class="link" href="https://help.talend.com/display/KB/Verifying+default+values+in+a+retrieved+schema" target="_top">https://help.talend.com/display/KB/Verifying+default+values+in+a+retrieved+schema</a>.</p>
						</td></tr><tr><td>&nbsp;</td><td>
							<p>
								<span class="emphasis"><em>Use existing connection</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box and in the <span class="emphasis"><strong>Component List</strong></span> click the
		relevant connection component to reuse the connection details you already defined.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>DB Version</em></span>
							</p>
						</td><td valign="top">
							<p>List of database versions.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Data Bucket</em></span></p>
						</td><td valign="top">
							<p>Name of the data bucket in the Couchbase database.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Username</em></span> and <span class="emphasis"><em>Password</em></span></p>
						</td><td valign="top">
							<p>Authentication credentials for a data bucket, instead of those for
								a server node.</p>
							<p>To enter the password, click the <span class="emphasis"><strong>[...]</strong></span> button next to the
		password field, and then in the pop-up dialog box enter the password between double quotes
		and click <span class="emphasis"><strong>OK</strong></span> to save the settings.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>URIs</em></span>
							</p>
						</td><td valign="top">
							<p>URIs of server nodes in the Couchbase cluster, in the form of
									<span class="emphasis"><em>"http://127.0.0.1:8091/pools"</em></span>
								or <span class="emphasis"><em>"http://localhost:8091/pools"</em></span>.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Key</em></span>
							</p>
						</td><td valign="top">
							<p>Schema field whose contents will be used as the ID of a document
								in the Couchbase database. </p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Value</em></span>
							</p>
						</td><td valign="top">
							<p>Schema field whose contents will be saved in the Couchbase
								database as binary documents.</p>
							<p>Available when <span class="emphasis"><strong>Include JSON
									Document</strong></span> is not selected.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Action on data</em></span>
							</p>
						</td><td valign="top">
							<p>The following operations are available: </p>
							<p>
								<span class="emphasis"><strong>Insert</strong></span>: insert data.</p>
							<p>
								<span class="emphasis"><strong>Update</strong></span>: update data.</p>
							<p>
								<span class="emphasis"><strong>Insert or Update</strong></span>: insert or update
								data.</p>
							<p>
								<span class="emphasis"><strong>Delete</strong></span>: delete data.</p>
						</td></tr><tr><td> </td><td valign="top">
							<p>
								<span class="emphasis"><em>Include JSON Document</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box for JSON configuration:</p>
							<p><span class="emphasis"><strong>Configure JSON Tree</strong></span>: click the <span class="emphasis"><strong>[...]</strong></span> button to open the interface for JSON tree
								configuration. For more information, see <a class="xref" href="tWriteJSONField.html#twritejsonfield_configuring_json_tree" title="Configuring a JSON Tree"><i>Configuring a JSON Tree</i></a>.</p>
							<p><span class="emphasis"><strong>Group by</strong></span>: click the <span class="emphasis"><strong>[+]</strong></span> button to add lines and choose the
								input columns for grouping the records.</p>
						</td></tr><tr><td>&nbsp;</td><td valign="top">
							<p>
								<span class="emphasis"><em>Die on error</em></span>
							</p>
						</td><td valign="top">
							<p>This check box is cleared by default, meaning to skip the row on
								error and to complete the process for error-free rows.</p>
						</td></tr><tr><td>
							<p><span class="emphasis"><strong>Advanced settings</strong></span></p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Expire</em></span>
							</p>
						</td><td valign="top">
							<p>Expiration value for a document. Defaulted to <span class="emphasis"><em>0</em></span>, it means the document will be stored
								indefinitely.</p>
							<p>The expiration time can either be a relative time (for example 60
								seconds), or absolute time (31st December 2020, 12:00pm). </p>
						</td></tr><tr><td>&nbsp;</td><td valign="top">
							<p>
								<span class="emphasis"><em>tStatCatcher Statistics</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to collect the log data at the component
								level.</p>
						</td></tr><tr><td valign="top">
							<p><span class="emphasis"><strong>Global Variables</strong></span></p>
						</td><td colspan="2">
							<p><span class="emphasis"><strong>NB_LINE</strong></span>: the number of rows read by an input component or
		transferred to an output component. This is an After variable and it returns an
		integer.</p>
							<p>
		<span class="emphasis"><strong>NB_LINE_INSERTED</strong></span>: the number of rows inserted. This is an
		After variable and it returns an integer.</p>
							<p>
		<span class="emphasis"><strong>NB_LINE_REJECTED</strong></span>: the number of rows rejected. This is an
		After variable and it returns an integer.</p>
							<p><span class="emphasis"><strong>ERROR_MESSAGE</strong></span>: the error message generated by the
		component when an error occurs. This is an After variable and it returns a string. This
		variable functions only if the <span class="emphasis"><strong>Die on error</strong></span> check box is
		cleared, if the component has this check box.</p>
							<p>A Flow variable functions during the execution of a component while an After variable
		functions after the execution of the component.</p>
							<p>To fill up a field or expression with a variable, press <span class="emphasis"><strong>Ctrl +
			Space</strong></span> to access the variable list and choose the variable to use from it. </p>
							<p> For further information about variables, see <span class="emphasis"><em>Talend Studio</em></span>
		<span class="emphasis"><em>User Guide</em></span>.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Preceded by an input component, <span class="emphasis"><strong>tCouchbaseOutput</strong></span> wraps flat data into JSON documents
								for storage in the Couchbase database.</p>
						</td></tr><tr><td valign="top"><p><span class="emphasis"><strong>Log4j</strong></span></p></td><td colspan="2" valign="top"><p>The activity of this component can be logged using the <span class="emphasis"><em>log4j</em></span> feature. For more information on this feature, see <span class="emphasis"><em>Talend Studio User
        Guide</em></span>.</p><p>For more information on the log4j logging levels, see the Apache documentation at <a class="link" href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Level.html" target="_top">http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Level.html</a>.</p></td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>n/a</p>
						</td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="andy-20130402-bigdata-tcouchbaseoutput-inserting_documents_to_data_bucket_in_ouchbase_database"></a>Scenario: Inserting documents to a data bucket in the Couchbase database</h3></div></div></div><p>This scenario inserts three blog posts to a data bucket in the Couchbase database. The
			source records are of flat data type and thus wrapped into JSON data before storage in
			the Couchbase database as documents. Note that the values of the source data field
				<span class="emphasis"><em>title</em></span>, which is selected as the <span class="emphasis"><strong>Key</strong></span> in the <span class="emphasis"><strong>Basic settings</strong></span> of
				<span class="emphasis"><strong>tCouchbaseOutput</strong></span>, are used as the document IDs in
			the Couchbase database.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9772"></a>Linking the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Drop <span class="emphasis"><strong>tCouchbaseConnection</strong></span>, <span class="emphasis"><strong>tFixedFlowInput</strong></span>, <span class="emphasis"><strong>tCouchbaseOutput</strong></span>, and <span class="emphasis"><strong>tCouchbaseClose</strong></span> onto the workspace.</p></li><li class="step"><p>Link <span class="emphasis"><strong>tCouchbaseConnection</strong></span> to <span class="emphasis"><strong>tFixedFlowInput</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step"><p>Link <span class="emphasis"><strong>tFixedFlowInput</strong></span> to <span class="emphasis"><strong>tCouchbaseOutput</strong></span> using a <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span>
						connection.</p></li><li class="step"><p>Link <span class="emphasis"><strong>tFixedFlowInput</strong></span> to <span class="emphasis"><strong>tCouchbaseClose</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p><div class="mediaobject" align="center"><img src="../images/use_case_tcouchbaseoutput_1.png" align="middle"></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9833"></a>Configuring the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Double-click <span class="emphasis"><strong>tCouchbaseConnection</strong></span> to open
						its <span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_2.png"></div></li><li class="step"><p>In the <span class="emphasis"><strong>Data Bucket</strong></span> field, enter the name
						of the data bucket in the Couchbase database. </p><p>In the <span class="emphasis"><strong>Password</strong></span> field, enter the password
						for access to the data bucket.</p><p>In the <span class="emphasis"><strong>URIs</strong></span> table, click the <span class="emphasis"><strong>[+]</strong></span> button to add lines as needed, where you can
						enter the URIs of the Couchbase server nodes.</p></li><li class="step"><p>Double-click <span class="emphasis"><strong>tFixedFlowInput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_3.png"></div><p>Select <span class="emphasis"><strong>Use Inline Content (delimited
							file)</strong></span> in the <span class="emphasis"><strong>Mode</strong></span>
						area.</p><p>In the <span class="emphasis"><strong>Content</strong></span> field, enter the data to
						write to the Couchbase database, for example:</p><pre class="programlisting">1;Andy;Integration at any scale;Talend, the leader of the DI space...
2;Andy;Data Integration Overview;Talend, the leading player in the DI field...
3;Andy;ELT Overview;Talend, the big name in the ELT circle...</pre></li><li class="step"><p>Click the <span class="emphasis"><strong>Edit schema</strong></span> button to open the
						schema editor.</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_5.png"></div></li><li class="step"><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add four columns,
						namely <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span> and
							<span class="emphasis"><em>contents</em></span>, of the string type.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to validate the setup and close
						the editor.</p></li><li class="step"><p>Click <span class="emphasis"><strong>tCouchbaseOutput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_4.png"></div></li><li class="step"><p>Select the <span class="emphasis"><strong>Use existing connection</strong></span> check
						box to reuse the connection.</p></li><li class="step"><p>In the <span class="emphasis"><strong>Key</strong></span> list, select the field
							<span class="emphasis"><em>title</em></span> whose values will be used as
						the IDs of documents inserted to the Couchbase database.</p></li><li class="step"><p>Select the <span class="emphasis"><strong>Generate JSON Document</strong></span> check
						box and click the <span class="emphasis"><strong>Configure JSON Tree</strong></span>
						button to open the JSON tree mapper.</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_6.png"></div></li><li class="step"><p>Press the <span class="emphasis"><strong>Shift</strong></span> key to select all the
						fields in the <span class="emphasis"><strong>Linker source</strong></span> area and drop
						them onto the <span class="emphasis"><strong>rootTag</strong></span> node in the <span class="emphasis"><strong>Link target</strong></span> part.</p></li><li class="step"><p>In the pop-up box, select <span class="emphasis"><strong>Create as sub-element of
							target node</strong></span>.</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_7.png"></div><p>Click <span class="emphasis"><strong>OK</strong></span> to validate the setup and close
						the box.</p></li><li class="step"><p>Right-click the <span class="emphasis"><strong>id</strong></span> node in the Link
						target part and select <span class="emphasis"><strong>Set as Loop Element</strong></span>
						from the contextual menu.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to validate the setup and close
						the mapper.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10009"></a>Executing the Job </h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step"><p>Press <span class="emphasis"><strong>F6</strong></span> to save and run the Job.</p></li><li class="step"><p>Go to the Couchbase web console and view the documents stored in the data
						bucket <span class="emphasis"><em>blog</em></span>:</p><div class="mediaobject"><img src="../images/use_case_tcouchbaseoutput_8.png"></div><p>As shown above, the source records have been saved in the Couchbase
						database in the form of JSON documents.</p></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tCouchbaseInput.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-bigdata.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="tCouchDBClose.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">tCouchbaseInput&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-components-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;tCouchDBClose</td></tr></table></div></body></html>