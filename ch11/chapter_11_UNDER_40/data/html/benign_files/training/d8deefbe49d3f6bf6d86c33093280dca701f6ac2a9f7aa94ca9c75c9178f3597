<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir='ltr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3332739511-widget_css_bundle.css' rel='stylesheet' type='text/css'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='http://sn0rt.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://sn0rt.blogspot.com/' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="INSTALACION DE SNORT - Atom" href="http://sn0rt.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="INSTALACION DE SNORT - RSS" href="http://sn0rt.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="INSTALACION DE SNORT - Atom" href="https://www.blogger.com/feeds/4417899603104918269/posts/default" />
<link rel="openid.server" href="https://www.blogger.com/openid-server.g" />
<link rel="openid.delegate" href="http://sn0rt.blogspot.com/" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<meta content='http://sn0rt.blogspot.com/' property='og:url'/>
<meta content='INSTALACION DE SNORT' property='og:title'/>
<meta content='' property='og:description'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>INSTALACION DE SNORT</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Son of Moto (Mean Green Blogging Machine variation)
Date:     23 Feb 2004
Updated by: Blogger Team
----------------------------------------------- */

/* Primary layout */
body {
margin: 0;
padding: 0;
border: 0;
text-align: center;
color: #555544;
background: #692 url(https://resources.blogblog.com/blogblog/data/moto_son/outerwrap.gif) top center repeat-y;
font-size: small;
}
img {
border: 0;
display: block;
}
.clear {
clear: both;
}
/* Wrapper */
#outer-wrapper {
margin: 0 auto;
border: 0;
width: 692px;
text-align: left;
background: #ffffff url(https://resources.blogblog.com/blogblog/data/moto_son/innerwrap.gif) top right repeat-y;
font: normal normal 100% tahoma, 'Trebuchet MS', lucida, helvetica, sans-serif;
}
/* Header */
#header-wrapper	{
background: #8b2 url(https://resources.blogblog.com/blogblog/data/moto_son/headbotborder.gif) bottom left repeat-x;
margin: 0 auto;
padding-top: 0;
padding-right: 0;
padding-bottom: 15px;
padding-left: 0;
border: 0;
}
#header h1 {
text-align: left;
font-size: 200%;
color: #ffffee;
margin: 0;
padding-top: 15px;
padding-right: 20px;
padding-bottom: 0;
padding-left: 20px;
background-image: url(https://resources.blogblog.com/blogblog/data/moto_son/topper.gif);
background-repeat: repeat-x;
background-position: top left;
}
h1 a, h1 a:link, h1 a:visited {
color: #ffffee;
}
#header .description {
font-size: 110%;
text-align: left;
padding-top: 3px;
padding-right: 20px;
padding-bottom: 10px;
padding-left: 23px;
margin: 0;
line-height:140%;
color: #ffffee;
}
/* Inner layout */
#content-wrapper {
padding: 0 16px;
}
#main {
width: 400px;
float: left;
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;     /* fix for long non-text content breaking IE sidebar float */
}
#sidebar {
width: 226px;
float: right;
color: #555544;
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;     /* fix for long non-text content breaking IE sidebar float */
}
/* Bottom layout */
#footer	{
clear: left;
margin: 0;
padding: 0 20px;
border: 0;
text-align: left;
border-top: 1px solid #f9f9f9;
}
#footer .widget	{
text-align: left;
margin: 0;
padding: 10px 0;
background-color: transparent;
}
/* Default links 	*/
a:link, a:visited {
font-weight: bold;
text-decoration: none;
color: #669922;
background: transparent;
}
a:hover {
font-weight: bold;
text-decoration: underline;
color: #88bb22;
background: transparent;
}
a:active {
font-weight : bold;
text-decoration : none;
color: #88bb22;
background: transparent;
}
/* Typography */
.main p, .sidebar p, .post-body {
line-height: 140%;
margin-top: 5px;
margin-bottom: 1em;
}
.post-body blockquote {
line-height:1.3em;
}
h2, h3, h4, h5	{
margin: 0;
padding: 0;
}
h2 {
font-size: 130%;
}
h2.date-header {
color: #555544;
}
.post h3 {
margin-top: 5px;
font-size: 120%;
}
.post-footer {
font-style: italic;
}
.sidebar h2 {
color: #555544;
}
.sidebar .widget {
margin-top: 12px;
margin-right: 0;
margin-bottom: 13px;
margin-left: 0;
padding: 0;
}
.main .widget {
margin-top: 12px;
margin-right: 0;
margin-bottom: 0;
margin-left: 0;
}
li  {
line-height: 160%;
}
.sidebar ul {
margin-left: 0;
margin-top: 0;
padding-left: 0;
}
.sidebar ul li {
list-style: disc url(https://resources.blogblog.com/blogblog/data/moto_son/diamond.gif) inside;
vertical-align: top;
padding: 0;
margin: 0;
}
.widget-content {
margin-top: 0.5em;
}
/* Profile
----------------------------------------------- */
.profile-datablock {
margin-top: 3px;
margin-right: 0;
margin-bottom: 5px;
margin-left: 0;
line-height: 140%;
}
.profile-textblock {
margin-left: 0;
}
.profile-img {
float: left;
margin-top: 0;
margin-right: 5px;
margin-bottom: 5px;
margin-left: 0;
border:4px solid #8b2;
}
#comments  {
border: 0;
border-top: 1px dashed #eed;
margin-top: 10px;
margin-right: 0;
margin-bottom: 0;
margin-left: 0;
padding: 0;
}
#comments h4	{
margin-top: 10px;
font-weight: normal;
font-style: italic;
text-transform: uppercase;
letter-spacing: 1px;
}
#comments dl dt 	{
font-weight: bold;
font-style: italic;
margin-top: 35px;
padding-top: 1px;
padding-right: 0;
padding-bottom: 0;
padding-left: 18px;
background: transparent url(https://resources.blogblog.com/blogblog/data/moto_son/commentbug.gif) top left no-repeat;
}
#comments dl dd	{
padding: 0;
margin: 0;
}
.deleted-comment {
font-style:italic;
color:gray;
}
.feed-links {
clear: both;
line-height: 2.5em;
}
#blog-pager-newer-link {
float: left;
}
#blog-pager-older-link {
float: right;
}
#blog-pager {
text-align: center;
}
/** Page structure tweaks for layout editor wireframe */
body#layout #outer-wrapper {
padding-top: 0;
}
body#layout #header,
body#layout #content-wrapper,
body#layout #footer {
padding: 0;
}

--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4417899603104918269&amp;zx=1846acda-c2fe-4618-8bf8-6595e4e21dbc' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4417899603104918269&amp;zx=1846acda-c2fe-4618-8bf8-6595e4e21dbc' rel='stylesheet'/></noscript>
</head>
<body>
<div class='navbar section' id='navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4417899603104918269\x26blogName\x3dINSTALACION+DE+SNORT\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dBLUE\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttp://sn0rt.blogspot.com/search\x26blogLocale\x3des\x26v\x3d2\x26homepageUrl\x3dhttp://sn0rt.blogspot.com/\x26vt\x3d153431980961763631',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div id='outer-wrapper'><div id='wrap2'>
<!-- skip links for text browsers -->
<span id='skiplinks' style='display:none;'>
<a href='#main'>skip to main </a> |
      <a href='#sidebar'>skip to sidebar</a>
</span>
<div id='header-wrapper'>
<div class='header section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
INSTALACION DE SNORT
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
<div id='content-wrapper'>
<div id='crosscol-wrapper' style='text-align:center'>
<div class='crosscol no-items section' id='crosscol'></div>
</div>
<div id='main-wrapper'>
<div class='main section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>3 de julio de 2007</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='http://bp2.blogger.com/_mKyc-O1yXL8/Rope98lPugI/AAAAAAAAAAM/VKgJcEsvxj4/s320/tool.JPG' itemprop='image_url'/>
<meta content='4417899603104918269' itemprop='blogId'/>
<meta content='7084534320533779478' itemprop='postId'/>
<a name='7084534320533779478'></a>
<h3 class='post-title entry-title' itemprop='name'>
<a href='http://sn0rt.blogspot.com/2007/07/manual-de-instalacin-de-snort.html'>MANUAL DE INSTALACIÓN DE SNORT</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7084534320533779478' itemprop='description articleBody'>
<div><br /><br />MANUAL DE INSTALACIÓN DE SNORT<br /><br />INTRODUCCIÓN<br /><br />Se instalo SNORT por disponer de una gran cantidad de filtros o patrones ya predefinidos, así como actualizaciones constantes ante casos de ataques, barridos o vulnerabilidades que vayan siendo detectadas a través de los distintos boletines de seguridad. Esta base de datos se actualiza constantemente. Los usuarios pueden crear 'firmas' basadas en las características de los nuevos ataques de red y enviarlas a la lista de correo de firmas de Snort, para que así todos los usuarios de Snort se puedan beneficiar. Esta ética de comunidad y compartir ha convertido a Snort en uno de los IDSes basados en red más populares, actualizados y robustos.<br /><br />Como plataforma CentOS por ser un sistema estable además de que ya se ha trabajado con él y no se ha tenido problema alguno.<br /><br />OBJETIVO<br /><br />El objetivo de este manual es compartir los conocimientos adquiridos en la instalación del IDS Snort bajo la plataforma de CentOS junto con la herramienta BASE para el análisis posterior de los datos recopilados.<br /><br />CONCEPTOS<br /><br />IDS (Intrusión Detection System) es un programa usado para detectar accesos desautorizados a un computador o a una red. Estos accesos pueden ser ataques de habilidosos hackers, o de Script Kiddies (es un cracker inexperto que usa programas, scripts, exploits, troyanos, nukes, etc. creados por terceros para romper la seguridad de un sistema).<br /><br />SNORT es un sniffer de paquetes y un detector de intrusos basado en red (se monitoriza todo un dominio de colisión). Es un software muy flexible que ofrece capacidades de almacenamiento de sus bitácoras tanto en archivos de texto como en bases de datos abiertas como lo es MySQL. Está disponible bajo licencia GPL, gratuito y funciona bajo plataformas Windows y UNIX/Linux.<br /><br />CentOS (acrónimo de Community ENTerprise Operating System) es un clon a nivel binario de la distribución Red Hat Enterprise Linux, compilado por voluntarios a partir del código fuente liberado por Red Hat, empresa desarrolladora de RHEL. CentOS usa yum para bajar e instalar las actualizaciones<br /><br />BASE (Basic Analysis and Security Engine)es un interfaz red que permite la gestión de las alertas generadas por la IDS Snort. Permite la clasificación de las alertas en grupo, la visualización de diagramas y la búsqueda de las alertas según distintos criterios.<br /><br />REQUISITOS PREVIOS<br /><br />La instalación esta bajo la plataforma de CentOS, la instalación se hizo de la siguiente forma:<br /><br />= Partición automática del disco duro<br />= Se eliminan todas las particiones del disco duro<br />= Se deshabilita el firewall y el soporte Selinux<br />= Los paquetes que se instalan son: editor VIM, base de datos MySQL y las herramientas de desarrollo<br /><br />ACTUALIZACION DEL SISTEMA<br /><br />Antes de hacer la actualización de nuestro sistema solo deben de estar activos los servicios: crond, sshd, iptables, network, sendmail y syslog; todos los demás servicios se deben dar de baja. Una opción es hacerlo manualmente con el comando<br /><br />chkconfig <servicio>off<br /><br />Para no dar de baja los servicios de uno en uno lo que se hizo fue establecer primero el lenguaje C, se checo el nivel de ejecución sobre el que se estaba trabajando (nivel 3), todos los servicios que en nivel 3 estén arriba se mando la salida a un archivo llamado servicios.on se realizo una copia de este con el nombre de servicios.off, esto se hizo con el fin de poder editar el archivo servicios.off y poder quitar de esa lista los servicios que necesitamos, salvamos el archivo y extraemos la primera columna del archivo para verificar que efectivamente ya no estén los servicios que requerimos, los servicios que tenemos en el archivo les cambiamos el valor por off , se le añade la extensión sh, se enlistan aquellos servicios que a nivel 3 tengan el valor de on, solo deben de estar los 6 que se enlistaron anteriormente<br /><br />LANG=C<br />runlevel<br />chkconfig - -list | grep 3:on > servicios.on<br />cp servicios.on servicios.off<br />vi servicios.off<br />awk &#8216;{print $1}&#8217; servicios.off<br />awk &#8216;{print &#8220;chkconfig - -level 3 &#8220;$1&#8221; off&#8221;}&#8217; servicios.off<br />awk &#8216;{print &#8220;chkconfig - -level 3 &#8220;$1&#8221; off&#8221;}&#8217; servicios.off | sh<br />chkconfig - -list | grep 3:on<br /><br />Primero importamos la llave y después bajamos las actualizaciones de CentOS<br /><br />rpm &#8211; -import http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-4<br /><br />yum &#8211;y update<br /><br />Tras la actualización procederemos a instalar las aplicaciones de desarrollo<br /><br />yum &#8211;y install mysql mysql-bench mysql-server mysql-devel mysqlclient10 php-mysql httpd gcc pcre-devel php-gd gd mod_ssl glib2-devel gcc-c++<br /><br />Ahora vamos a iniciar Apache y MySQL y debemos de asegurarnos que se inicien junto con el arranque del sistema, para ello vamos a escribir lo siguiente:<br /><br />chkconfig httpd on<br />chkconfig mysql on<br />service httpd start<br />service mysql start<br /><br />En la página de prueba de APACHE, vamos a cambiarla por una herramienta de red en la cual podremos realizar pings, traceroute, etc., vamos a trabajar desde el directorio /var/www/html<br /><br /><a href="http://bp2.blogger.com/_mKyc-O1yXL8/Rope98lPugI/AAAAAAAAAAM/VKgJcEsvxj4/s1600-h/tool.JPG"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5082979547768404482" src="http://bp2.blogger.com/_mKyc-O1yXL8/Rope98lPugI/AAAAAAAAAAM/VKgJcEsvxj4/s320/tool.JPG" style="DISPLAY: block; MARGIN: 0px auto 10px; CURSOR: hand; TEXT-ALIGN: center" /></a><br /><br /><br />cd /var/www/html<br />wget http://www.internetsecurityguru.com/index.php.txt<br />mv index.php.txt index.php<br /><br />Creamos un directorio el cual se va a utilizar para bajar los paquetes que vamos a instalar<br /><br />cd root/<br />mkdir snortinstall<br /><br />INSTALACIÓN DEL SNORT<br /><br />cd snortinstall<br />wget http://www.snort.org/dll/current/snort-2.6.1.2.tar.gz<br />tar &#8211;xvzf snort-2.6.1.2.tar.gz<br />mv snort-2.6.1.2 /root<br />cd snort-2.6.1.2<br />./configure &#8211;-with-mysql &#8211;-enable-dynamicplugin<br />make<br />make install<br /><br />groupadd snort<br />useradd &#8211;g snort snort &#8211;s /sbin/nologin<br /><br />mkdir /etc/snort<br />mkdir /etc/snort/rules<br />mkdir /var/log/snort<br />cd etc/ (vamos a entrar al etc que esta dentro del directorio snort-2.6.1.2)<br />cp */etc/snort<br /><br />cd /root/snortinstall<br /><br />Para poder obtener las reglas de la página oficial del snort, debemos de estar suscritos a snort. Esta suscripción nos permite tener actualizaciones continuas de la base de datos de reglas .<br /><br />Otra opción que tenemos es registrarnos en la web para poder tener acceso a estas reglas, las cuales son una versión reducida de las reglas oficiales de pago y se actualizan periódicamente. Se opto por esta opción ya que de lo contrario las reglas que no requieren pago ni registro en la página se actualizan cada que vez que se publica una nueva versión del Snort.<br /><br />Se realizo el registro en la página de snort y se descargo el fichero en una memoria USB (http://www.snort.org/pub-bin/downloads.cgi/Download/sub_rules/snortrules-snapshot-CURRENT_s.tar.gz)para posteriormente pasarlas al servidor, para ello se creo un directorio llamado USB en el cual se monto la USB<br /><br />cd /root<br />mkdir usb<br />mount /dev/sdc1 usb/<br />cd usb<br />cp snortrules-snapshot-CURRENT_s.tar.gz /root/snortinstall<br />cd /root<br />umount usb<br />cd snortinstall<br />tar &#8211;xvzf snortrules-snapshot-CURRENT_s.tar.gz<br /><br />mv docs/signatures /etc/snort/doc/<br />mv rules/* /etc/snort/rules<br />mv /root/snort-2.6.1.2/etc/*.conf* /etc/snort<br /><br />MODIFICACIÓN DEL ARCHIVO snort.conf<br /><br />Vamos a modificar unas líneas del fichero que esta en /etc/snort.<br />Valores sustituidos<br /><br />var HOME_NET any<br />var HOME_NET 200.66.106.0/27 (esta variable define el rango de direcciones que snort controlara usando el formato CIDR)<br /><br />var EXTERNAL_NET any<br />var EXTERNAL_NET !$HOME_NET (diremos que todo aquello que no sea HOME_NET quedará definido como redes Externas)<br /><br />var RULE_PATH ../RULES<br />var RULE_PATH /etc/snort/rules (define el directorio donde Snort buscará los ficheros de reglas para la detección de anomalía en el tráfico de la red)<br /><br />preprocessor stream4_reassemble<br />preprocessor stream4_reassemble: both,ports 21 23 25 53 80 110 111 139 143 445 513 1433<br /><br />preprosessor http_inspect: global<br />iis_unicode_map unicode.map 1252<br /><br />preprosessor http_inspect: global<br />iis_unicode_map unicode.map /etc/snort/rules/unicode.map 1252<br /><br />Buscamos más abajo del fichero, en la sección de salidas y vamos a descomentar la siguiente línea, cambiamos unos datos y hay que acordarse del password que le pongamos al snort ya que más adelante la vamos a ocupar de nuevo.<br /><br />#output database: log, mysql, user=root password=test dbname=db host=localhost<br /><br />output database: log, mysql, user=snort password=<asignamos><br />dbname=snort host=localhost<br /><br />CONFIGURANDO A SNORT PARA QUE INICIE CON EL SISTEMA<br /><br />Tenemos que estar en el directorio /etc/init.d<br /><br />cd /etc/init.d<br />wget http://internetsecurityguru.com/snortinit/snort<br />chmod 755 snort<br />chkconfig snort on<br /><br />CREANDO LA BASE DE DATOS EN MYSQL<br /><br />En MySQL, un punto y coma &#8220; ; &#8221; es obligatorio en el extremo de cada línea de entrada, &#8216;password ' es la contraseña que uno asigne. Para el uso del usuario del snort el &#8216;password&#8217; es aquel que se puso en la sección de la salida del snort.conf en la sección de arriba.<br /><br />mysql<br />mysql> SET PASSWORD FOR root@localhost=PASSWORD('password');<br />>Query OK, 0 rows affected (0.25 sec)<br />mysql> create database snort;<br />>Query OK, 1 row affected (0.01 sec)<br />mysql> grant INSERT,SELECT on root.* to snort@localhost;<br />>Query OK, 0 rows affected (0.02 sec)<br />mysql> SET PASSWORD FOR snort@localhost=PASSWORD('password_from_snort.conf');<br />>Query OK, 0 rows affected (0.25 sec)<br />mysql> grant CREATE, INSERT, SELECT, DELETE, UPDATE on snort.* to snort@localhost;<br />>Query OK, 0 rows affected (0.02 sec)<br />mysql> grant CREATE, INSERT, SELECT, DELETE, UPDATE on snort.* to snort;<br />>Query OK, 0 rows affected (0.02 sec)<br />mysql> exit<br />>Bye<br /><br />EJECUTE LOS SIGUIENTES COMANDOS PARA LA CREACIÓN DE LAS TABLAS<br /><br />mysql -u root -p < /root/snort-2.6.1.2/schemas/create_mysql snort Enter password: password Ahora debemos comprobar y cerciorarnos de que la base de datos de Snort fue creada correctamente mysql -p Enter password:password mysql> SHOW DATABASES;<br />(es lo que debe de desplegarnos)<br />+------------+<br />| Database<br />+------------+<br />| mysql<br />| Snort<br />| test<br />+------------+<br />3 rows in set (0.00 sec)<br />mysql> use snort<br />>Database changed<br />mysql> SHOW TABLES;<br />+------------------+<br />| Tables_in_snort<br />+------------------+<br />| data<br />| detail<br />| encoding<br />| event<br />| icmphdr<br />| iphdr<br />| opt<br />| reference<br />| reference_system<br />| schema<br />| sensor<br />| sig_class<br />| sig_reference<br />| signature<br />| tcphdr<br />| udphdr<br />+------------------+<br />16 rows in set (0.00 sec)<br />exit;<br /><br />INSTALANDO B.A.S.E.<br /><br />Desde nuestro directorio de descargas (/root/snortinstall), instalaremos utilerías para la representación gráfica.<br /><br />cd /root/snortinstall<br />pear install Image_Graph-alpha Image_Canvas-alpha Image_Color Numbers_Roman<br /><br />DESCARGANDO ADODB<br /><br />wget http://easynews.dl.sourceforge.net/sourceforge/adodb/adodb494.tgz<br /><br />DESCARGANDO BASE<br /><br />wget http://easynews.dl.sourceforge.net/sourceforge/secureideas/base-1.2.7.tar.gz<br /><br />INSTALANDO ADODB<br /><br />cd /var/www/<br />tar -xvzf /root/snortinstall/adodb494.tgz<br /><br />INSTALANDO Y CONFIGURANDO B.A.S.E.<br /><br />cd /var/www/html<br />tar &#8211;xvzf /root/snortinstall/base-1.2.7.tar.gz<br />mv base-1.2.7/ base/<br />Se realiza una copia del archive base_conf.php.dist por base_conf.php<br />cp base_conf.php.dist base_conf.php<br />Editamos el archivo base_conf.php y modificamos unos valores. Valores cambiados<br /><br />$BASE_urlpath = &#8216;&#8217;;<br />$BASE_urlpath = &#8216;/base&#8217;;<br />$DBlib_path = &#8216;&#8217;;<br />$DBlib_path = &#8216;/var/www/adodb/&#8216;;<br />$DBtype = &#8216;mysql&#8217;;<br />$alert_dbname = &#8216;snort&#8217;;<br />$alert_dbname = &#8216;snort_log&#8217;;<br />$alert_host = &#8216;localhost&#8217;;<br />$alert_port = &#8216;&#8217;;<br />$alert_user = &#8216;snort&#8217;;<br />$alert_password = &#8216;password del archive snort.conf&#8217;;<br /><br />CONFIGURANDO SNORT PARA QUE INICIE CON EL SISTEMA<br /><br />chkconfig snort on<br />service snort start<br /><br />Desde nuestro browser accesaremos a nuestro equipo<br /><br /><a href="http://ip.address/base">http://IP.address<ip.address>/base</a><br /><br /><a href="http://bp3.blogger.com/_mKyc-O1yXL8/Ropf9MlPuhI/AAAAAAAAAAU/sRylliNoJKU/s1600-h/base.JPG"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5082980634395130386" src="http://bp3.blogger.com/_mKyc-O1yXL8/Ropf9MlPuhI/AAAAAAAAAAU/sRylliNoJKU/s320/base.JPG" style="DISPLAY: block; MARGIN: 0px auto 10px; CURSOR: hand; TEXT-ALIGN: center" /></a><br /><br />Damos click en donde dice Setup page<br /><br /><a href="http://bp0.blogger.com/_mKyc-O1yXL8/RopgbclPuiI/AAAAAAAAAAc/bQhdOptMnLQ/s1600-h/setup.JPG"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5082981154086173218" src="http://bp0.blogger.com/_mKyc-O1yXL8/RopgbclPuiI/AAAAAAAAAAc/bQhdOptMnLQ/s320/setup.JPG" style="DISPLAY: block; MARGIN: 0px auto 10px; CURSOR: hand; TEXT-ALIGN: center" /></a><br /><br /><br />Terminado ya el proceso damos click en home y nos muestra la siguiente pantalla<br /><br /><a href="http://bp3.blogger.com/_mKyc-O1yXL8/RophJMlPujI/AAAAAAAAAAk/ahTwG3nm-pw/s1600-h/alert.JPG"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5082981940065188402" src="http://bp3.blogger.com/_mKyc-O1yXL8/RophJMlPujI/AAAAAAAAAAk/ahTwG3nm-pw/s320/alert.JPG" style="DISPLAY: block; MARGIN: 0px auto 10px; CURSOR: hand; TEXT-ALIGN: center" /></a><br /><br /><br />ASEGURANDO EL DIRECTORIO B.A.S.E<br /><br />mkdir /var/www/passwords<br />/usr/bin/htpasswd -c /var/www/passwords/passwords base (Solicitara ingresar una contraseña que nosotros elijamos para este usuario, éste es el que tendremos que mecanografiar cuando ingresemos a nuestra B.A.S.E.)<br /><br />Editaremos el archivo httpd.conf para agregar unos datos<br /><br />vi /etc/httpd/conf/httpd.conf<br /><br />Buscaremos las siguientes líneas:<br /><br /><directory><br />Options FollowSymLinks<br />AllowOverride None<br /></directory><br />Éstas son las líneas que se deben agregar enseguida de las anteriores con esto protegemos la consola B.A.S.E. con la contraseña que configuramos<br /><br /><directory><><br />AuthType Basic<br />AuthName "SnortIDS"<br />AuthUserFile /var/www/passwords/passwords<br />Require user base<br /></directory>< /Directory ><br /><br />INSTALANDO NTOP VIA YUM<br /><br />En /etc/yum.repos.d creamos un archivo llamado dag.repo (vi dag.repo) y agregamos las siguientes líneas<br /><br />[dag] name=Dag RPM Repository for Red Hat Enterprise Linux<br />baseurl=http://apt.sw.be/redhat/el$releasever/en/$basearch/dag/<br />gpgcheck=1<br />enabled=1<br /><br />Importamos la llave GPG<br /><br />wget http://dag.wieers.com/packages/RPM-GPG-KEY.dag.txt<br />rpm &#8211; -import /ruta_donde_se_guardo_la_llave/*KEY*<br />yum install ntop<br /><br />Terminada la descarga procedemos a editar el archivo ntop.conf (vi /etc/ntop.conf) para realizar unos cambios<br /><br />### Interface(s) that ntop will capture on (default: eth0)<br />#--interface eth0<br />--interface eth1 (cambiamos el valor de la eth de acuerdo a la interfaz que utilizamos)<br /><br />### Sets the port that the HTTP webserver listens on<br />### NOTE: --http-server 3000 is the default<br />#--http-server 3000<br />--http-server 3000 (fijamos el puerto en el cual el webserver del HTTP nos va a escuchar)<br /><br />Ahora vamos a fijar un password para ntop.conf<br /><br />/usr/bin/ntop @/etc/ntop.conf &#8211;A (en cuanto demos enter nos va a solicitar una contraseña y la confirmación de la misma)<br /><br />Regresamos a editar el archivo ntop.conf, para descomentar una línea y hacer que se ejecute como demonio. Valor cambiado<br /><br />#--daemon<br />--daemon<br /><br />Vamos a iniciar el servicio y configurarlo para que se inicie junto con el sistema<br /><br />chkconfig ntop on<br />service ntop start<br />http://IP.address:3000 (de esta forma entramos por medio de nuestro navegador al ntop)<br /><br /><a href="http://bp2.blogger.com/_mKyc-O1yXL8/Rophv8lPukI/AAAAAAAAAAs/viv2knPx5zQ/s1600-h/iftop.JPG"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5082982605785119298" src="http://bp2.blogger.com/_mKyc-O1yXL8/Rophv8lPukI/AAAAAAAAAAs/viv2knPx5zQ/s400/iftop.JPG" style="DISPLAY: block; MARGIN: 0px auto 10px; CURSOR: hand; TEXT-ALIGN: center" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Publicado por
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<span itemprop='name'>Shely</span>
</span>
</span>
<span class='post-timestamp'>
en
<meta content='http://sn0rt.blogspot.com/2007/07/manual-de-instalacin-de-snort.html' itemprop='url'/>
<a class='timestamp-link' href='http://sn0rt.blogspot.com/2007/07/manual-de-instalacin-de-snort.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2007-07-03T07:29:00-07:00'>7:29</abbr></a>
</span>
<span class='reaction-buttons'>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='https://www.blogger.com/comment.g?blogID=4417899603104918269&postID=7084534320533779478' onclick=''>
No hay comentarios:
    </a>
</span>
<span class='post-backlinks post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-action'>
<a href='https://www.blogger.com/email-post.g?blogID=4417899603104918269&postID=7084534320533779478' title='Enviar entrada por correo electrónico'>
<img alt='' class='icon-action' height='13' src='https://resources.blogblog.com/img/icon18_email.gif' width='18'/>
</a>
</span>
<span class='item-control blog-admin pid-1197831362'>
<a href='https://www.blogger.com/post-edit.g?blogID=4417899603104918269&postID=7084534320533779478&from=pencil' title='Editar entrada'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<a class='home-link' href='http://sn0rt.blogspot.com/'>Página principal</a>
</div>
<div class='clear'></div>
<div class='blog-feeds'>
<div class='feed-links'>
Suscribirse a:
<a class='feed-link' href='http://sn0rt.blogspot.com/feeds/posts/default' target='_blank' type='application/atom+xml'>Entradas (Atom)</a>
</div>
</div>
<script type='text/javascript'>
    window.___gcfg = { 'lang': 'es' };
  </script>
</div></div>
</div>
<div id='sidebar-wrapper'>
<div class='sidebar section' id='sidebar'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Archivo del blog</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://sn0rt.blogspot.com/2007/'>
2007
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://sn0rt.blogspot.com/2007/07/'>
julio
</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='http://sn0rt.blogspot.com/2007/07/manual-de-instalacin-de-snort.html'>MANUAL DE INSTALACIÓN DE SNORT</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=4417899603104918269&widgetType=BlogArchive&widgetId=BlogArchive1&action=editWidget&sectionId=sidebar' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' target='configBlogArchive1' title='Editar'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div>
</div>
</div>
<!-- spacer for skins that want sidebar and main to be the same height-->
<div class='clear'>&#160;</div>
</div>
<!-- end content-wrapper -->
<div id='footer-wrapper'>
<div class='footer no-items section' id='footer'></div>
</div>
</div></div>
<!-- end outer-wrapper -->
<script src='https://apis.google.com/js/plusone.js' type='text/javascript'></script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3953819307-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY5g4ZbbPXwPONqenQElaakZMc3YEQ:1516547470458';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4417899603104918269','//sn0rt.blogspot.com/','4417899603104918269');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4417899603104918269', 'title': 'INSTALACION DE SNORT', 'url': 'http://sn0rt.blogspot.com/', 'canonicalUrl': 'http://sn0rt.blogspot.com/', 'homepageUrl': 'http://sn0rt.blogspot.com/', 'searchUrl': 'http://sn0rt.blogspot.com/search', 'canonicalHomepageUrl': 'http://sn0rt.blogspot.com/', 'blogspotFaviconUrl': 'http://sn0rt.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'es', 'localeUnderscoreDelimited': 'es', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22INSTALACION DE SNORT - Atom\x22 href\x3d\x22http://sn0rt.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22INSTALACION DE SNORT - RSS\x22 href\x3d\x22http://sn0rt.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22INSTALACION DE SNORT - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4417899603104918269/posts/default\x22 /\x3e\n', 'meTag': '', 'openIdOpTag': '\x3clink rel\x3d\x22openid.server\x22 href\x3d\x22https://www.blogger.com/openid-server.g\x22 /\x3e\n\x3clink rel\x3d\x22openid.delegate\x22 href\x3d\x22http://sn0rt.blogspot.com/\x22 /\x3e\n', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/c912efb304a7668f', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'sharing': {'platforms': [{'name': 'Obtener enlace', 'key': 'link', 'shareMessage': 'Obtener enlace', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Compartir en Facebook', 'target': 'facebook'}, {'name': 'Escribe un blog', 'key': 'blogThis', 'shareMessage': 'Escribe un blog', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Compartir en Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Compartir en Pinterest', 'target': 'pinterest'}, {'name': 'Google+', 'key': 'googlePlus', 'shareMessage': 'Compartir en Google+', 'target': 'googleplus'}, {'name': 'Correo electrónico', 'key': 'email', 'shareMessage': 'Correo electrónico', 'target': 'email'}], 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27es\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Leer más', 'pageType': 'index', 'pageName': '', 'pageTitle': 'INSTALACION DE SNORT'}}, {'name': 'features', 'data': {'lazy_images': 'false', 'unsupported_browser_message': 'false', 'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Editar', 'linkCopiedToClipboard': 'El enlace se ha copiado en el Portapapeles.', 'ok': 'Aceptar', 'postLink': 'Enlace de la entrada'}}, {'name': 'template', 'data': {'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'INSTALACION DE SNORT', 'description': '', 'url': 'http://sn0rt.blogspot.com/', 'type': 'feed', 'isSingleItem': false, 'isMultipleItems': true, 'isError': false, 'isPage': false, 'isPost': false, 'isHomepage': true, 'isArchive': false, 'isLabelSearch': false}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'useNgc': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/172053108-lbx__es.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/368954415-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Cargando\x26hellip;'}, 'displayModeFull'));
</script>
</body>
</html>