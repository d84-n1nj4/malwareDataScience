<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="a461f381-8612-4ce1-a0dc-68bcaca028d0" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>WEBC2-UGX (FAMILY)</short_description>
  <description>A WEBC2 backdoor is designed to retrieve a Web page from a pre-determined C2 server. It expects the Web page to contain special HTML tags; the backdoor will attempt to interpret the data between the tags as commands. Members of this family of malware provide remote command shell and remote file download and execution capabilities.
The malware downloads a web page containing a crafted HTML comment that subsequently contains an encoded command. The contents of this command tell the malware whether to download and execute a program, launch a reverse shell to a specific host and port number, or to sleep for a period of time. </description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">WEBC2-UGX</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Backdoor</link>
  </links>
  <definition>
    <Indicator operator="OR" id="f97ec627-8a79-484e-b889-de21ed02a4d4">
      <IndicatorItem id="09576f11-2a61-4ba4-b028-50915af3ff1f" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">8412a3e37499f8289faf54546824ab61</Content>
      </IndicatorItem>
      <IndicatorItem id="115348b8-1dd2-47c8-b7c5-e527d1f16290" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">56de2854ef64d869b5df7af5e4effe3e</Content>
      </IndicatorItem>
      <IndicatorItem id="dabc9e54-b4df-4a27-8d9a-08d88d81ecba" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">9e30b1665077b7e65bc8ff1e7c752306</Content>
      </IndicatorItem>
      <IndicatorItem id="f9485db8-ca16-4b54-a70f-81e48aa8e01e" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">106338ad223b84fbc2528a55e3e22302</Content>
      </IndicatorItem>
      <IndicatorItem id="fbbfe38f-d0e2-485d-b646-50a95ad67e42" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">8462a62f13f92c34e4b89a7d13a185ad</Content>
      </IndicatorItem>
      <IndicatorItem id="b9dc8abb-9158-4977-b086-0f1168f36326" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">15d1330be5e27f6f51d011b0575ffa05</Content>
      </IndicatorItem>
      <IndicatorItem id="919418e6-81e1-4fe4-b3d4-8387d2994158" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">75dad1ccabae8adeb5bae899d0c630f8</Content>
      </IndicatorItem>
      <IndicatorItem id="bfd57cda-e423-4f87-82d2-dcad4c60a4e1" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">4b19a2a6d40a5825e868c6ef25ae445e</Content>
      </IndicatorItem>
      <IndicatorItem id="2f1fa842-f779-4fa9-b56b-26ba8607dbdb" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">54d5d171a482278cc8eacf08d9175fd7</Content>
      </IndicatorItem>
      <IndicatorItem id="be2960e4-3574-43dd-95ba-3cb4513152ea" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">36a7c3a6460c98e161e1005c925da0b2</Content>
      </IndicatorItem>
      <IndicatorItem id="6401f7da-2c4d-4b72-828d-b69a295581f1" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0fbdc6e3f79063a4773d4872fa1f15d1</Content>
      </IndicatorItem>
      <Indicator operator="AND" id="e988e9e9-dc1e-410e-a2f0-eb780672649e">
        <Indicator operator="OR" id="0522c806-9232-4045-b6fe-5716bccaa832">
          <IndicatorItem id="392ba790-2c1e-4acd-86db-7e1246788195" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">acrod32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f8bc290b-0168-4d53-afe5-02bcfc8a3f82" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">adobearm.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="ae2d031d-f8f4-4be1-95eb-dde6c523716a" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">winword.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="e1ca34f2-6f66-4a8e-ae99-b231aea90ac7" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">defwatch.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="416c4674-b9f7-40a1-96b2-dc688e28eca4" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">contains_eof_data</Content>
            <Comment>PE Header Anomaly identified in 100% samples.</Comment>
          </IndicatorItem>
          <IndicatorItem id="615cf836-6147-40de-b0b9-10dab8393ed9" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
            <Comment>PE Header Anomaly identified in 91% samples.</Comment>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="3f136b50-a274-4ec5-84ff-b89d02b04d36">
          <IndicatorItem id="64868346-be1b-4343-ab0a-60a6579ae58e" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">18142</Content>
          </IndicatorItem>
          <IndicatorItem id="466e6f8e-dcc9-43e8-b1fa-1eb6b509923c" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">20313</Content>
          </IndicatorItem>
          <IndicatorItem id="32100cf1-610b-461f-b9c4-ff24bdc9f023" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">20314</Content>
          </IndicatorItem>
          <IndicatorItem id="6ce23dff-9674-463b-a3ca-24627166ec3d" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">34138</Content>
          </IndicatorItem>
          <IndicatorItem id="eb9c7619-beb5-4323-8380-dc71c80788ca" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">81754</Content>
          </IndicatorItem>
          <IndicatorItem id="e9c54005-c94a-4863-b6ff-8195d62237d8" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">85574</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="0d4a7d56-0008-42c3-b726-9702674535a8">
          <IndicatorItem id="0d4e7c5d-31b5-4741-98aa-f5b43ae77c2c" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2007-09-17T09:21:03Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a53c2636-8a86-4edb-9038-ded5af8c9da2" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-03-06T14:10:18Z</Content>
          </IndicatorItem>
          <IndicatorItem id="c25d74ab-cd2c-4dc2-b66e-320bfb658c5e" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-06-11T09:35:04Z</Content>
          </IndicatorItem>
          <IndicatorItem id="be83cacb-1875-461f-8c9d-5c54b35a8e95" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-03-15T12:47:10Z</Content>
          </IndicatorItem>
          <IndicatorItem id="ae13d20a-fa0f-42cb-92cf-4a6145d6b8d1" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-06-25T09:26:47Z</Content>
          </IndicatorItem>
          <IndicatorItem id="d249a870-df60-4c2d-8c88-5eca53ad3afa" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-03-29T08:40:16Z</Content>
          </IndicatorItem>
          <IndicatorItem id="611abf4e-9345-4f81-a17e-9b37fa80df41" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-09-06T12:37:01Z</Content>
          </IndicatorItem>
          <IndicatorItem id="1fdbe819-1261-40f5-af34-f3891ee08f74" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-09-20T01:17:47Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a1a9931d-9305-4154-9863-174cdedb89d4" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-01-20T03:14:28Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="ff265e40-8a75-4c15-9c0e-ea603f58e14c">
        <IndicatorItem id="8cc88d4a-c3a4-493c-9ccb-a287f1ffd336" condition="contains">
          <Context document="ProcessItem" search="ProcessItem/HandleList/Handle/Type" type="mir" />
          <Content type="string">Mutant</Content>
          <Comment>Mutexes created by different variants of this family</Comment>
        </IndicatorItem>
        <Indicator operator="OR" id="7cab174d-6a75-4dda-87d8-83c56dd1932e">
          <IndicatorItem id="b3352aec-e4f9-4c70-9eab-2881bd91bbd2" condition="is">
            <Context document="ProcessItem" search="ProcessItem/HandleList/Handle/Name" type="mir" />
            <Content type="string">BaseNamedObjects\Sm</Content>
          </IndicatorItem>
          <IndicatorItem id="efa96288-2925-4365-b9c4-9288c4b914e3" condition="is">
            <Context document="ProcessItem" search="ProcessItem/HandleList/Handle/Name" type="mir" />
            <Content type="string">1qasw2</Content>
          </IndicatorItem>
          <IndicatorItem id="d9cc65c8-8dd2-4713-b6b7-ce3f805ee413" condition="is">
            <Context document="ProcessItem" search="ProcessItem/HandleList/Handle/Name" type="mir" />
            <Content type="string">ijnrfv</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
