<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="7f9a6986-f00a-4071-99d3-484c9158beba" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>WEBC2-RAVE (FAMILY)</short_description>
  <description>A WEBC2 backdoor is designed to retrieve a Web page from a pre-determined C2 server. It expects the Web page to contain special HTML tags; the backdoor will attempt to interpret the data between the tags as commands. This family of malware will set itself up as a service and connect out to a hardcoded web page and read a modified base64 string from this webpage. The later versions of this malware supports three commands (earlier ones are just downloaders or reverse shells). The first commands will sleep the malware for N number of hours. The second command will download a binary from the encoded HTML comment and execute it on the infected host. The third will spawn an encoded reverse shell to an attacker specified location and port.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">WEBC2-RAVE</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Backdoor</link>
  </links>
  <definition>
    <Indicator operator="OR" id="f96c7900-0cf5-4199-b314-860a1cdc008e">
      <IndicatorItem id="c1add49c-34fa-45bc-8cba-3bb3b6b94d36" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3fc26910f9c31bd9ba3ccb09132d9ca3</Content>
      </IndicatorItem>
      <IndicatorItem id="4de1e7fa-5a91-48c3-83bb-3ad3df36f9a8" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f81991fab3b7d58d66629e26d21176ed</Content>
      </IndicatorItem>
      <IndicatorItem id="16d2c8e0-8743-47d9-b0ff-11334904bc98" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2198fea94bb79b001fcfd3e03b269001</Content>
      </IndicatorItem>
      <IndicatorItem id="48884b2b-ad30-4db8-8f3c-581f22d62b90" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">dba356a4726b94731e6ea97aa73cfc3f</Content>
      </IndicatorItem>
      <IndicatorItem id="8232c084-291c-4708-8621-630359641277" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a44312eb63de002383a57b5a93271cdc</Content>
      </IndicatorItem>
      <IndicatorItem id="182b86fb-ffec-4448-816f-e25e0ba3e927" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">9f11bc08af048c5c3a110e567082fe0b</Content>
      </IndicatorItem>
      <IndicatorItem id="1ecb09bf-e519-408d-a92a-4bec3ef167b1" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">ef349196b0ffef5a02d30413c8dffc7c</Content>
      </IndicatorItem>
      <IndicatorItem id="469d5a32-a749-4e77-801f-28c5fe0f0121" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">76c1b246703a10cb6e71a3e5b7b55b24</Content>
      </IndicatorItem>
      <IndicatorItem id="fd7d9f58-aa4a-4fa0-bbd5-6ed59aa9a8ab" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">dc1cff84900afc9d292b305f9b9aae34</Content>
      </IndicatorItem>
      <IndicatorItem id="22eec523-087c-4b59-902c-b2a5f1df45f0" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">bdd2ad4c0e1e5667d117810ae9e36c4b</Content>
      </IndicatorItem>
      <IndicatorItem id="677903f5-6e57-4b39-b290-151ba6e64fed" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">277f95bff2e0fe317f86b5010bd83a18</Content>
      </IndicatorItem>
      <IndicatorItem id="1e1b5109-1c26-47f3-b27f-e3da4d1bf5dd" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">1aea4d24f3bd2c51288ad643fc66e0d2</Content>
      </IndicatorItem>
      <IndicatorItem id="67dc9478-25b9-44eb-bb64-e7849b9eea43" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">d197c388184fef263b7944a7186bc6db</Content>
      </IndicatorItem>
      <IndicatorItem id="69efd08f-e2f8-4cad-8cf8-d223be8ccdd9" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">129c6cd9d2aa895cf6fa137fa1d3a188</Content>
      </IndicatorItem>
      <IndicatorItem id="f6040ecd-84ef-4406-9997-0ffdfc6532e1" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">c8d2b7f92fff545b3b19e9b1e1057071</Content>
      </IndicatorItem>
      <IndicatorItem id="05f84536-25ed-4200-bc4e-85854a2520bf" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">5bcaa2f4bc7567f6ffd5507a161e221a</Content>
      </IndicatorItem>
      <IndicatorItem id="99592600-6255-43e4-bdca-68c6e8d1d0fe" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">438983192903f3fecf77500a39459ee6</Content>
      </IndicatorItem>
      <IndicatorItem id="0a172ac5-81f9-4e74-b7fc-e8fd3b156ff6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">59620925bf1c4f760c4bf225c7efd6c0</Content>
      </IndicatorItem>
      <IndicatorItem id="5f3ca7cf-f431-4d67-874d-ce0429742120" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">bca9bd0abbb31a422458abf521a6a2fb</Content>
      </IndicatorItem>
      <IndicatorItem id="4753ad6e-f925-4d00-8b8a-93cd9a793961" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">db5805604f84b7303fa04feb18ce8271</Content>
      </IndicatorItem>
      <IndicatorItem id="16ff8b63-7417-4ad3-af39-f5fc3293a81a" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0e84132e5ad04351b644b8d8743fc4d3</Content>
      </IndicatorItem>
      <IndicatorItem id="1e515fc4-5298-4835-ac93-ccc29f70c273" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a2534e9b7e4146368ea3245381830eb0</Content>
      </IndicatorItem>
      <IndicatorItem id="a96fc990-5cbf-4655-8119-ae542b9eb1a6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">04f481d6710ac5d68d0eacac2600a041</Content>
      </IndicatorItem>
      <IndicatorItem id="6ecaf030-ef79-4a73-9176-cf8add0928ae" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">bf0ee4367ea32f8e3b911c304258e439</Content>
      </IndicatorItem>
      <IndicatorItem id="c89cc114-47b9-4900-bde2-eed6e36fb1b0" condition="contains">
        <Context document="RegistryItem" search="RegistryItem/Path" type="mir" />
        <Content type="string">services\devfs</Content>
        <Comment>registry entries created by some variants</Comment>
      </IndicatorItem>
      <IndicatorItem id="4e70e655-7d8b-47e3-87b2-2b78e4d24e4c" condition="contains">
        <Context document="RegistryItem" search="RegistryItem/Path" type="mir" />
        <Content type="string">services\oseasv</Content>
        <Comment>registry entries created by some variants</Comment>
      </IndicatorItem>
      <Indicator operator="AND" id="360d69d5-6897-4007-8345-e954ad37bbb0">
        <Indicator operator="OR" id="ce8a4b65-765f-405d-b9f1-806e326de58b">
          <IndicatorItem id="33b87f92-bfe4-4cbc-a278-9f23b62c7872" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">sacard.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d7e3e563-91f7-4e47-bffc-41ed83c6dcf5" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">mci.jpg</Content>
          </IndicatorItem>
          <IndicatorItem id="8711b161-c87c-49ef-95e3-6e911e29df38" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">dfhost.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="a5a39c19-de7c-4537-b28e-eecb16ad5a69" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">wmicide.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="3fb9550e-647e-4470-844d-d3e4afbdfac4" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">wmiprvse.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="0f962e45-4e79-453d-b246-9d88c2e3ba3a" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">listen.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="9be9c7e6-ef4b-4098-a644-a81f62a47a68" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">oobewmiprvse.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="449d46a7-a9bb-4732-ba06-e10eaa0bc64d" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">a.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="01d37248-c597-4266-95e1-6aabc1f7c1c9" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">msctcwmiprvse.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="11e35c8c-ef8c-4000-b312-040c3e20d217" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">winsrv.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f58b9ef8-d1e4-4c30-a610-cde6f2ee64c0" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">adress.jpg</Content>
          </IndicatorItem>
          <IndicatorItem id="f3768548-3229-44e3-9d18-5db1c1644dc7" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">adress2.jpg</Content>
          </IndicatorItem>
          <IndicatorItem id="8ba28033-24e9-4b18-868a-0e239729c5ed" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">abc.gif</Content>
          </IndicatorItem>
          <IndicatorItem id="9fed2d7d-2f5d-491f-b5ce-0183a298a3a2" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">devfs.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="6522aad9-947b-4f63-a2be-20d0d0f26a9d" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">cft.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="bfdf0133-a503-4d67-be46-2cfb4be9f305" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">contains_eof_data</Content>
            <Comment>PE Header Anomaly identified in 12% samples.</Comment>
          </IndicatorItem>
          <IndicatorItem id="7927d9ba-06fd-4a77-b3a7-cb3038d6afb5" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
            <Comment>PE Header Anomaly identified in 100% samples.</Comment>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="6f22129d-f752-4e6a-a293-dacb2d9d5eac">
          <IndicatorItem id="87b67e2a-ca0d-481f-b39e-1837ed188a57" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">11264</Content>
          </IndicatorItem>
          <IndicatorItem id="b9322946-8901-4d77-a1be-e466fd6601a4" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">13824</Content>
          </IndicatorItem>
          <IndicatorItem id="cb8c47c3-6fe5-49e3-b6c6-2d51ee247717" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">13825</Content>
          </IndicatorItem>
          <IndicatorItem id="c348c561-9c3f-49b9-9808-a170c48e5461" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">15872</Content>
          </IndicatorItem>
          <IndicatorItem id="36cfc9da-bf4f-4c12-bfef-2f840b50730e" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">15873</Content>
          </IndicatorItem>
          <IndicatorItem id="4fdee7b7-190e-4198-a3a7-bd46c5b2dfe5" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">16384</Content>
          </IndicatorItem>
          <IndicatorItem id="55820c9e-d099-4e0f-abe7-79d4d5e29ea8" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">8704</Content>
          </IndicatorItem>
          <IndicatorItem id="c5173eec-a8ad-4064-9ebf-8d8991e2eb60" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">9216</Content>
          </IndicatorItem>
          <IndicatorItem id="dfb7e07f-0306-4ec0-91be-26410393f1b4" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">9728</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="e67f0d37-6dbd-4e50-aa1d-eb74f5702e8c">
          <IndicatorItem id="2eedbeb8-e2cc-4cd4-9dfa-ef29128b1f76" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-07-02T07:45:46Z</Content>
          </IndicatorItem>
          <IndicatorItem id="51c7acd6-9d75-4ed4-a439-48c08b52b930" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-10-27T07:23:52Z</Content>
          </IndicatorItem>
          <IndicatorItem id="86ce12af-1d2c-4de8-b488-aa1dcd582817" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2009-11-11T06:33:02Z</Content>
          </IndicatorItem>
          <IndicatorItem id="7805a253-7812-4d78-baee-3f397ecb4ffd" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-06-29T00:31:41Z</Content>
          </IndicatorItem>
          <IndicatorItem id="79829e8c-e486-4988-8985-72798b068a19" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-08-04T02:47:55Z</Content>
          </IndicatorItem>
          <IndicatorItem id="9e3edd07-bc07-4e7b-a5f2-df985855a0ca" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-09-19T08:33:34Z</Content>
          </IndicatorItem>
          <IndicatorItem id="b5a279f6-2539-41c7-97c0-c95e4072b099" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-09-19T08:34:11Z</Content>
          </IndicatorItem>
          <IndicatorItem id="593686f2-abdd-4550-8c5c-564b1393afaa" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-12-06T00:38:26Z</Content>
          </IndicatorItem>
          <IndicatorItem id="8147833c-a9c1-405a-b127-02d64bd9b75b" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-21T16:30:21Z</Content>
          </IndicatorItem>
          <IndicatorItem id="47c27957-4181-4db6-a75e-bfaa93aa1e32" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-02-28T11:48:43Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="fe742a39-dcf4-448b-921f-ec6201252ffd">
        <IndicatorItem id="8efe257a-6b96-4e36-8729-1f3694c81b9c" condition="contains">
          <Context document="ServiceItem" search="ServiceItem/description" type="mir" />
          <Content type="string">Saves installation files used for updates and repairs and is required for the downloading of Setup updates and Watson error reports.</Content>
          <Comment>service information set up by some variants of this malware</Comment>
        </IndicatorItem>
        <Indicator operator="OR" id="b0154d79-9d79-4483-97c3-c3df885bc79d">
          <IndicatorItem id="9ac41220-f3fd-4f72-8262-6277dec37103" condition="contains">
            <Context document="ServiceItem" search="ServiceItem/descriptiveName" type="mir" />
            <Content type="string">Device File System</Content>
          </IndicatorItem>
          <IndicatorItem id="53d3278c-fdb4-4b02-b274-d3c101bb88b5" condition="contains">
            <Context document="ServiceItem" search="ServiceItem/descriptiveName" type="mir" />
            <Content type="string">Office Engine Service</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="01cedd3a-096e-4744-b0ef-746da37e2c45">
          <IndicatorItem id="fea984ed-f114-4ab0-aa3f-242eedd4e9fc" condition="contains">
            <Context document="ServiceItem" search="ServiceItem/name" type="mir" />
            <Content type="string">DevFS</Content>
          </IndicatorItem>
          <IndicatorItem id="fde7acb4-88a3-46ee-a098-ead6ed6e3907" condition="contains">
            <Context document="ServiceItem" search="ServiceItem/name" type="mir" />
            <Content type="string">OSEASV</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="ca140995-5fd9-42f4-b4e5-969526867613">
        <IndicatorItem id="1c56079b-e20c-4bb0-a4aa-983bad429b05" condition="contains">
          <Context document="RegistryItem" search="RegistryItem/Path" type="mir" />
          <Content type="string">\services\devfs\dependondevice</Content>
          <Comment>registry entries created by some variants</Comment>
        </IndicatorItem>
        <IndicatorItem id="ff1d640b-7855-4b82-8d5f-a3a40aba300d" condition="is">
          <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
          <Content type="string">plugplay</Content>
        </IndicatorItem>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
