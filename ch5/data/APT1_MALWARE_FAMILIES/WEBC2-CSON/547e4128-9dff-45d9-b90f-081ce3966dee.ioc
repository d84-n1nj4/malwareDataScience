<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="547e4128-9dff-45d9-b90f-081ce3966dee" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>WEBC2-CSON (FAMILY)</short_description>
  <description>A WEBC2 backdoor is designed to retrieve a Web page from a pre-determined C2 server. It expects the Web page to contain special HTML tags; the backdoor will attempt to interpret the data between the tags as commands. Members of this family of malware act only as downloaders and droppers for other malware. They communicate with a hard-coded C2 server, reading commands embedded in HTML comment fields. Some variants are executables which act upon execution, others are DLLs which can be attached to services or loaded through search order hijacking.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">WEBC2-CSON</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Downloader</link>
  </links>
  <definition>
    <Indicator operator="OR" id="f799cdd4-57ae-40e9-8ee6-bcacc3f39430">
      <IndicatorItem id="99b0c203-fbaf-4183-ae63-48d0c03a7a81" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a38a367d6696ba90b2e778a5a4bf98fd</Content>
      </IndicatorItem>
      <IndicatorItem id="b72e9e6f-f135-44cd-8e38-60ffd2000af7" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">4a2320b41a5216c741bf63fce562961a</Content>
      </IndicatorItem>
      <IndicatorItem id="e51dac46-9e38-40cd-bd9e-cf9389335a9b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">5537bdce991797198a9ff97ff1492f90</Content>
      </IndicatorItem>
      <IndicatorItem id="92f27bf2-cb73-4afb-b6bc-aeb93af236f0" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0115338e11f85d7a2226933712acaae8</Content>
      </IndicatorItem>
      <IndicatorItem id="fc847913-f158-46a4-add6-d0aed12df4e9" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">277964807a66aeeb6bd81dbfcaa3e4e6</Content>
      </IndicatorItem>
      <IndicatorItem id="82513330-ebdd-470d-b685-8ce6bb1d0e40" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f802b6e448c054c9c16b97ff85646825</Content>
      </IndicatorItem>
      <IndicatorItem id="4933aae2-b99b-41b4-b654-0238c60a6570" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">7d3140bd028f70f1fa865364b69c5999</Content>
      </IndicatorItem>
      <IndicatorItem id="571eceed-e749-47c9-816d-34514ae8f5ce" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">18316e6ebb356a66c8ff51e73c1bcc8a</Content>
      </IndicatorItem>
      <IndicatorItem id="731a7370-2ef4-47ec-b6cb-0411aebc569a" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">91dc97c4b66e3282e1aa831e0bb0bb14</Content>
      </IndicatorItem>
      <IndicatorItem id="11d72f66-8aad-4b9c-b89e-51294de134fa" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">53600687ec97c297f03b4f0f4710d0c5</Content>
      </IndicatorItem>
      <IndicatorItem id="890885aa-18c6-4b74-b0c7-a0bd1a3fbe53" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">4192479b055b2b21cb7e6c803b765d34</Content>
      </IndicatorItem>
      <IndicatorItem id="6eb51a17-ac61-43b4-b143-702960315b01" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">51ce169debea41314f591290839fd55f</Content>
      </IndicatorItem>
      <IndicatorItem id="f0acb752-f234-49da-856b-c4487188f8d5" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">50f35b7c86aede891a72fcb85f06b0b7</Content>
      </IndicatorItem>
      <IndicatorItem id="cb922a65-89da-40a4-af9a-db39ba0d5583" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">575836ebb1b8849f04e994e9160370e4</Content>
      </IndicatorItem>
      <IndicatorItem id="1cf863d3-59e1-437c-b7ad-dd88da1aff34" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">73d125f84503bd87f8142cf2ba8ab05e</Content>
      </IndicatorItem>
      <IndicatorItem id="b7bc323b-eeb8-4da1-ad82-0bbd909840c2" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">d22863c5e6f098a4b52688b021beef0a</Content>
      </IndicatorItem>
      <IndicatorItem id="e1cf1ca2-3b82-4499-a464-27d411fba154" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3ea7bf3b469499f0f6d4a78af865138f</Content>
      </IndicatorItem>
      <IndicatorItem id="10cdbd63-b615-43ba-906f-3ff38e20f666" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">2d57aa4e7f2f4088f1b96313b24c7602</Content>
      </IndicatorItem>
      <IndicatorItem id="289a5c12-ab3d-4d16-a4e2-7f86a170dc70" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">d6a01b61f490488d61dfb9376186d844</Content>
      </IndicatorItem>
      <IndicatorItem id="197c995d-798b-4c39-ac93-8a709c27fae0" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">b1ee00cec6c2318fa86f320dd7fc99a8</Content>
      </IndicatorItem>
      <IndicatorItem id="634443c8-e62a-4ab1-9508-5ad706983db4" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">6ca59c9c4165796e08ba6ca3eeffdee6</Content>
      </IndicatorItem>
      <IndicatorItem id="0f45ef31-8176-4181-842d-b44e0f860613" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">66c287675cd4c7172590f71181e723a8</Content>
      </IndicatorItem>
      <IndicatorItem id="7e925178-0290-4676-b6ea-5c968af2989f" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f1e5d9bf7705b4dc5be0b8a90b73a863</Content>
      </IndicatorItem>
      <IndicatorItem id="03019da0-4e35-44a9-8bf6-c0134cce58e5" condition="contains">
        <Context document="FileItem" search="FileItem/FullPath" type="mir" />
        <Content type="string">\WINDOWS\ntshrui.dll</Content>
        <Comment>the variant with ntshrui.dll attempts to load before the real ntshrui.dll through search order hijacking, and placing itself in the \WINDOWS dir vs. \WINDOWS\SYSTEM32</Comment>
      </IndicatorItem>
      <IndicatorItem id="f5359852-097e-4247-8723-df6bf72d9ecc" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">Y29ubmVjdA==</Content>
        <Comment>an encoding string seen in about a third of the samples of this family (and in other APT1 families of malware)</Comment>
      </IndicatorItem>
      <Indicator operator="AND" id="81cd696e-3759-4e2e-9092-d61044ecf466">
        <Indicator operator="OR" id="4da387cf-0346-46ee-8567-459e3a2b450a">
          <IndicatorItem id="46df33f3-bff7-48b2-9545-9dea89b2b94f" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">update.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="e8870f2d-6496-48ea-b50c-14d2f2791c2c" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">AcroRd32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="13c7ff58-1d87-4898-96a0-98ad886763e2" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">svchost.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="77dcc436-2e07-47c7-ae81-7fb7cf50a00a" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">nwsapagent.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="3eff6eba-23e3-4a00-bdac-87d1992d58fb" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">update.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="ff53cd17-3267-44fe-af63-ae0859a26161" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">regsvr.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="bc60be82-0891-46be-8dd4-1f2447464e33" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">cmd.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="da0cc592-b519-47c3-90fd-a9b9dd694e3c" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">ntshrui.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="67c82cfd-e7a3-42dc-87ae-6a626509473e" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">ipripp.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="b1a94d3c-71a2-4cd3-bf7c-fbd146f3ec75" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">web.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f810aca4-4035-4630-9b91-f9a2b08b5d49" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">dataaa.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="d3234aca-7aa1-477b-a767-873e569d15f0" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">dc120.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="9c596030-7a74-4293-8513-e7bcb9bc2138" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">udaterui.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="c4ed36db-92b3-4c62-af77-925e69929e5d" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">firefox.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="4669a304-91b2-4882-b79a-4e3e54fdf162" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
            <Comment>PE Header Anomaly identified in 100% samples.</Comment>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="9a48b472-977c-4731-bc28-aaf8abe99c4e">
          <IndicatorItem id="55dc3ac8-da7c-4158-91c1-1b1b6f02269c" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">10240</Content>
          </IndicatorItem>
          <IndicatorItem id="c18bf4e6-71c9-4a60-9e8c-c896582d65fd" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">24064</Content>
          </IndicatorItem>
          <IndicatorItem id="d124c4c2-a338-48b3-b7c7-9eb1987f4f21" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">33280</Content>
          </IndicatorItem>
          <IndicatorItem id="a98a90bc-e817-4985-ba97-1a18a4aa1790" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">55808</Content>
          </IndicatorItem>
          <IndicatorItem id="aca8b54d-9576-414f-994b-2440455093b4" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">66048</Content>
          </IndicatorItem>
          <IndicatorItem id="dc662c94-c50f-44ba-99c4-a0b4f4df4d73" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">83456</Content>
          </IndicatorItem>
          <IndicatorItem id="08060761-ace3-47c9-b091-1f41a8d335a2" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">9728</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="a78754e0-1986-442c-b159-a45b379f1b93">
          <IndicatorItem id="960e594f-6f05-44c7-85b5-eaa2c696f419" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-12-02T08:05:26Z</Content>
          </IndicatorItem>
          <IndicatorItem id="5182a2da-a3ed-4dae-aebb-aabe3dad350d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-12-03T03:07:18Z</Content>
          </IndicatorItem>
          <IndicatorItem id="6f191ca4-9764-4b9a-ac98-091565e1d76e" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2010-12-22T08:02:25Z</Content>
          </IndicatorItem>
          <IndicatorItem id="5f7bc992-2cb5-4de3-8f83-090e6dba53e7" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-03-07T09:42:59Z</Content>
          </IndicatorItem>
          <IndicatorItem id="40b37830-e5a6-4c7d-98c7-952c9b25d4ce" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-03-23T14:34:10Z</Content>
          </IndicatorItem>
          <IndicatorItem id="8fac18cc-a583-4c19-af3c-277390909c1d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-03-23T14:36:19Z</Content>
          </IndicatorItem>
          <IndicatorItem id="1014039c-105b-4461-a51e-6836ecbc1d1d" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-14T07:22:24Z</Content>
          </IndicatorItem>
          <IndicatorItem id="f2f4573e-7377-4252-88da-7539aacb674f" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-04-21T07:51:21Z</Content>
          </IndicatorItem>
          <IndicatorItem id="303c96ec-01ef-4f0c-9c62-335ae16c879a" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-09-20T03:40:51Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a8f5799b-1b35-4125-802b-e052a5a23605" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-09-20T03:50:48Z</Content>
          </IndicatorItem>
          <IndicatorItem id="5e94b2ae-a2bc-4df8-b42d-af92b62a4636" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-10-27T09:35:26Z</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="8056c6e7-a12b-4e11-9abf-e86e7beb750f">
        <IndicatorItem id="7be68113-1abe-4400-96a7-1975c65afa51" condition="contains">
          <Context document="FileItem" search="FileItem/PEInfo/Type" type="mir" />
          <Content type="string">dll</Content>
          <Comment>The dll variants of this malware family all appear to have this specific resource section</Comment>
        </IndicatorItem>
        <IndicatorItem id="f6cbabdb-f0d4-4a5d-9108-a05ffd2063eb" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/ResourceInfoList/ResourceInfoItem/Type" type="mir" />
          <Content type="string">EXE</Content>
        </IndicatorItem>
        <Indicator operator="OR" id="7d8cae57-24b9-42f3-803d-444c67d616f7">
          <IndicatorItem id="40d193f4-f81c-4284-b5b7-16fcdcaf11ed" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/ResourceInfoList/ResourceInfoItem/Name" type="mir" />
            <Content type="string">111</Content>
          </IndicatorItem>
          <IndicatorItem id="467aa9b4-db05-4af3-8845-6ec7a77edf55" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/VersionInfoList/VersionInfoItem/Language" type="mir" />
            <Content type="string">Chinese (Simplified, PRC)</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="a513eeb4-3aef-4550-80ad-47452f11037f">
        <IndicatorItem id="8c74d0c8-4c0a-4ca1-b32e-b5fb7e1f9dff" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/DllName" type="mir" />
          <Content type="string">eventsystem.dll</Content>
          <Comment>describes a DLL used in the majority of DLLs instances of this family</Comment>
        </IndicatorItem>
        <IndicatorItem id="573e75c3-d30c-4c7e-9eb6-2413e7dae467" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">uninstallA</Content>
        </IndicatorItem>
        <IndicatorItem id="6490093a-f01f-46ec-966f-2a253086df2d" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">installA</Content>
        </IndicatorItem>
        <IndicatorItem id="8e855941-0540-4666-91c5-cc00f590ef8f" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">UninstallService</Content>
        </IndicatorItem>
        <IndicatorItem id="ac9d0ce4-ae62-4bff-8e3e-51700dbd06db" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">InstallService</Content>
        </IndicatorItem>
        <IndicatorItem id="151c88cd-5f32-4907-95e7-634e59e33c2b" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/ExportedFunctions/string" type="mir" />
          <Content type="string">ServiceMain</Content>
        </IndicatorItem>
        <IndicatorItem id="cc5d6946-59c1-4051-b4bc-9a75a97b8ed3" condition="is">
          <Context document="FileItem" search="FileItem/PEInfo/Exports/NumberOfFunctions" type="mir" />
          <Content type="int">5</Content>
        </IndicatorItem>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
