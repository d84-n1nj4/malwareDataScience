<?xml version="1.0" encoding="us-ascii"?>
<ioc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="86f988b7-fa02-46df-8e19-e50ce37f0fed" last-modified="2013-02-10T13:00:00" xmlns="http://schemas.mandiant.com/2010/ioc">
  <short_description>COOKIEBAG (FAMILY)</short_description>
  <description>This family of malware is a backdoor capable of file upload and download as well as providing remote interactive shell access to the compromised machine.
Communication with the Command &amp; Control (C2) servers uses a combination of single-byte XOR and Base64 encoded data in the Cookie and Set-Cookie HTTP header fields. Communication with the C2 servers is over port 80. Some variants install a registry key as means of a persistence mechanism. The hardcoded strings cited include a string of a command in common with several other APT1 families.</description>
  <authored_by>Mandiant</authored_by>
  <authored_date>2013-02-10T06:11:53</authored_date>
  <links>
    <link rel="family">COOKIEBAG</link>
    <link rel="threatgroup">APT</link>
    <link rel="family">APT1</link>
    <link rel="category">Backdoor</link>
  </links>
  <definition>
    <Indicator operator="OR" id="809eca7a-fb86-44eb-b355-403c58e2159a">
      <IndicatorItem id="79abb1a5-bbf6-43af-8467-532f71c6dd87" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">73a63c21a08b0ad2c69999e448f8e6a1</Content>
      </IndicatorItem>
      <IndicatorItem id="04e77da2-5b8a-412b-a399-f469ec0e04b6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a4903f7c293993069f865468bd7cec78</Content>
      </IndicatorItem>
      <IndicatorItem id="00351da5-c885-484e-bc72-aad44ed08e51" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0c28ad34f90950bc784339ec9f50d288</Content>
      </IndicatorItem>
      <IndicatorItem id="7bd94800-81f8-4dfa-b249-03d98b0b9606" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">e6c25f9994b723d39c785ddfd38a31b8</Content>
      </IndicatorItem>
      <IndicatorItem id="33c801e0-2c42-4dd8-b596-2db00964a928" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">6ab7fa8e5fb63b8d0723387d0a1ffe6d</Content>
      </IndicatorItem>
      <IndicatorItem id="59522153-7522-482b-8bb6-010211a6737a" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">989b797c2a63fbfc8e1c6e8a8ccd6204</Content>
      </IndicatorItem>
      <IndicatorItem id="0b06b091-69d3-4914-a234-bdf613539c68" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">0cad42671e5771574df44a23b3634f32</Content>
      </IndicatorItem>
      <IndicatorItem id="db9d2702-a55a-406e-9d02-46afead92b6e" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">57326cd78a56d26e349bbd4bcc5b9fa2</Content>
      </IndicatorItem>
      <IndicatorItem id="f17fffc0-839f-4ad1-8d74-0db32124b8e6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">543e03cc5872e9ed870b2d64363f518b</Content>
      </IndicatorItem>
      <IndicatorItem id="81a255ee-0927-4ad9-9fba-9aab5e6cd76f" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">db2580f5675f04716481b24bb7af468e</Content>
      </IndicatorItem>
      <IndicatorItem id="5849c3c1-d099-4733-b03e-8c56711194d0" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">687a58dcbc076b04bef4ec6050310fb5</Content>
      </IndicatorItem>
      <IndicatorItem id="f08759f3-d4cc-4309-a7e2-8c6fdbbce80b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">609d917a7f0c526b0d8091c8191da376</Content>
      </IndicatorItem>
      <IndicatorItem id="2ccebfa9-1eaa-460e-9341-8a96a2ff7a2b" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f9a46d5024c05a827912a89ca270c553</Content>
      </IndicatorItem>
      <IndicatorItem id="f547229b-7a04-431e-b56b-09ac98678697" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">a311516cdf06d3db4f49e67da5213ebe</Content>
      </IndicatorItem>
      <IndicatorItem id="7215d193-972f-444c-aa18-a61daabc04a6" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">f3611c5c793f521f7ff2a69c22d4174e</Content>
      </IndicatorItem>
      <IndicatorItem id="c1343674-dd87-49a0-a4a3-a27d0818dc18" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">c21591aa72ac72872f5bd05bbca5e4da</Content>
      </IndicatorItem>
      <IndicatorItem id="b7c91545-2a05-4b62-b1dd-1fb71e82ab89" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">3e72fd40e47e232496b303734f1b2b11</Content>
      </IndicatorItem>
      <IndicatorItem id="e3b2626b-c7d3-4a44-a824-6bf850243237" condition="is">
        <Context document="FileItem" search="FileItem/Md5sum" type="mir" />
        <Content type="md5">321d75c9990408db812e5a248a74f8c8</Content>
      </IndicatorItem>
      <IndicatorItem id="d1810518-b626-4311-a145-1c4598d7a1ac" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">YzpcXHdpbmRvd3NcXHN5c3RlbTMyXFxjbWQuZXhl</Content>
        <Comment>common string found in all observed variants of this family</Comment>
      </IndicatorItem>
      <IndicatorItem id="bd6b2ced-0f3c-4049-b8fc-7c616fb7b8a9" condition="is">
        <Context document="FileItem" search="FileItem/StringList/string" type="mir" />
        <Content type="string">Y21kLmV4ZQ==</Content>
        <Comment>string in common w/ other APT1 malware families found in all observed variants of this family</Comment>
      </IndicatorItem>
      <Indicator operator="AND" id="afee0590-19b9-4126-876b-bfb17ebd7abf">
        <Indicator operator="OR" id="45742288-6707-47b5-9969-8fe7508f96d1">
          <IndicatorItem id="ff943c0a-9e58-4386-ad14-34015d84e415" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">126976</Content>
          </IndicatorItem>
          <IndicatorItem id="1440d9e1-ac2b-4070-9c52-18c09764e9e5" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">131072</Content>
          </IndicatorItem>
          <IndicatorItem id="3439977d-e115-4d8f-b132-0ad1d43a03f9" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">151552</Content>
          </IndicatorItem>
          <IndicatorItem id="710c48a6-5469-4bd4-92eb-e42e88513684" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">152064</Content>
          </IndicatorItem>
          <IndicatorItem id="7141fe94-297a-4e1b-84ae-27750d6ca75f" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">167936</Content>
          </IndicatorItem>
          <IndicatorItem id="084208aa-67d9-4c4f-94b6-f6473e2d2145" condition="is">
            <Context document="FileItem" search="FileItem/SizeInBytes" type="mir" />
            <Content type="int">64000</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="a59ef15a-1121-44af-9043-8585cc55903c">
          <IndicatorItem id="c0e76f51-65b3-4674-8f40-0e9f3c0aad5e" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-06-03T08:09:58Z</Content>
          </IndicatorItem>
          <IndicatorItem id="8e459a03-786e-43e3-855b-e20e6335e26b" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-07-18T03:10:56Z</Content>
          </IndicatorItem>
          <IndicatorItem id="925a2eca-69c1-4ffb-b40f-2cacb6b7a5cb" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-10-12T01:58:10Z</Content>
          </IndicatorItem>
          <IndicatorItem id="82dd6cbd-30f3-4cea-a8c9-740a546241d4" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-11-16T15:07:45Z</Content>
          </IndicatorItem>
          <IndicatorItem id="b3633486-591f-4efb-b237-0e4fb02ad91c" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2011-11-22T01:15:22Z</Content>
          </IndicatorItem>
          <IndicatorItem id="e63613fd-a9a1-4a98-ad5a-fdc220e0441f" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-03-12T01:34:56Z</Content>
          </IndicatorItem>
          <IndicatorItem id="fabb74b2-60b0-41d4-a5c0-36352424c0e5" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-03-13T03:47:57Z</Content>
          </IndicatorItem>
          <IndicatorItem id="a6b24c9d-1a03-45af-914b-6acf27687c54" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-03-14T14:29:00Z</Content>
          </IndicatorItem>
          <IndicatorItem id="01537a75-9e1b-40ca-8f89-9c86be215732" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-04-17T07:24:52Z</Content>
          </IndicatorItem>
          <IndicatorItem id="351316b2-0c9e-4f14-8378-2c501708d770" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-06-19T07:21:24Z</Content>
          </IndicatorItem>
          <IndicatorItem id="0c587488-54ba-4632-842b-61bf5f1312af" condition="is">
            <Context document="FileItem" search="FileItem/PEInfo/PETimeStamp" type="mir" />
            <Content type="date">2012-06-11T12:37:20Z</Content>
          </IndicatorItem>
        </Indicator>
        <Indicator operator="OR" id="dcbb72e5-50e0-47ab-99a2-fd0deecb35e7">
          <IndicatorItem id="afa38bcf-b80a-47ee-9c0a-2fdf6dba7f9e" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">acrod32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="1a17e869-fc4d-41da-b236-9dbcb88d6ff2" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">updata.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="7e48992d-2ff8-4f80-9889-8f35073af141" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">windows.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="5a7e8dc6-f0af-4758-850b-0df033d97e1a" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">acrord32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="0c04da43-6de5-4333-a254-8242134172c5" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">204.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="6023b32f-45a6-47ea-ac7c-fbffd35f6e80" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">windows.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="2935559c-5d93-4b38-9e37-4e5f2b6286f9" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">update.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="dfcc4c5d-2f42-41c4-9f23-47761e3b131b" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">googlee.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="0d4c14c4-1429-4ccd-a920-2b2a0d1e41f2" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">codeguru.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="3eb5f738-d087-4dc5-8163-8223166aa1ca" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">google.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="7eb89e1e-6d8b-44e7-97ac-5506f6011ac9" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">66.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f3ad0de3-9089-49e6-8089-e5833e066c20" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">services.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="4ffae2b5-e390-4300-93f7-34c5fcc55faf" condition="is">
            <Context document="FileItem" search="FileItem/FileName" type="mir" />
            <Content type="string">data.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="f080431e-deb2-48f1-8daf-cc3fb38f2808" condition="contains">
            <Context document="FileItem" search="FileItem/PEInfo/DetectedAnomalies/string" type="mir" />
            <Content type="string">checksum_is_zero</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="a8a18d7a-87fe-479f-8f9b-9bb19046230c">
        <IndicatorItem id="59a60655-c1e2-449d-b3bd-42a445a7e6bd" condition="contains">
          <Context document="RegistryItem" search="RegistryItem/Path" type="mir" />
          <Content type="string">Software\Microsoft\Windows Nt\CurrentVersion\load</Content>
          <Comment>registry key created by some variants of this malware family</Comment>
        </IndicatorItem>
        <Indicator operator="OR" id="b0bcd3f9-efef-4b03-bbef-866cc63d0437">
          <IndicatorItem id="3a115c77-5a93-4252-bdd7-5c6d15a72786" condition="contains">
            <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
            <Content type="string">windows.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="245a22dc-f856-4b97-85a0-7429e8b5fd48" condition="contains">
            <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
            <Content type="string">acrord32.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="abb701e7-f05a-40b0-8fdd-4b5ffa109252" condition="contains">
            <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
            <Content type="string">winword.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="66bf87e0-dc35-49ae-9dad-4a9eab4d8e7c" condition="contains">
            <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
            <Content type="string">google.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="8aa681bc-f5be-489b-b449-203212e81e58" condition="contains">
            <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
            <Content type="string">204.exe</Content>
          </IndicatorItem>
          <IndicatorItem id="07122710-2023-41d4-8dff-a5948c54bb07" condition="contains">
            <Context document="RegistryItem" search="RegistryItem/Text" type="mir" />
            <Content type="string">acrod32.exe</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
    </Indicator>
  </definition>
</ioc>
